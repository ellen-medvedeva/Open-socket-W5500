A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     1


MACRO ASSEMBLER A51 V8.02b
OBJECT MODULE PLACED IN Main.OBJ
ASSEMBLER INVOKED BY: D:\Keil_v5\C51\BIN\A51.EXE Main.a51 NOMOD51 SET(SMALL) DEBUG EP

LOC  OBJ            LINE     SOURCE

                       1     ;$include (c8051F120.inc)
                +1     2     ;---------------------------------------------------------------------------
                +1     3     ; Copyright (C) 2003 CYGNAL INTEGRATED PRODUCTS, INC.
                +1     4     ; All rights reserved.
                +1     5     ;
                +1     6     ;
                +1     7     ; FILE NAME: C8051F120.INC
                +1     8     ; TARGET MCUs: C8051F120, F121, F122, F123, F124, F125, F126, F127
                +1     9     ; DESCRIPTION: Register/bit definitions for the C8051F120 product family.
                +1    10     ;
                +1    11     ; REVISION 1.6
                +1    12     ;
                +1    13     ;---------------------------------------------------------------------------
                +1    14     
                +1    15     ;REGISTER DEFINITIONS
                +1    16     ;
  0080          +1    17     P0             DATA 080H    ; PORT 0 LATCH
  0081          +1    18     SP             DATA 081H    ; STACK POINTER
  0082          +1    19     DPL            DATA 082H    ; DATA POINTER LOW BYTE
  0083          +1    20     DPH            DATA 083H    ; DATA POINTER HIGH BYTE
  0084          +1    21     SFRPAGE        DATA 084H    ; SFR PAGE SELECT
  0085          +1    22     SFRNEXT        DATA 085H    ; SFR STACK NEXT PAGE
  0086          +1    23     SFRLAST        DATA 086H    ; SFR STACK LAST PAGE
  0087          +1    24     PCON           DATA 087H    ; POWER CONTROL
  0088          +1    25     FLSTAT         DATA 088H    ; FLASH STATUS
  0088          +1    26     CPT0CN         DATA 088H    ; COMPARATOR 0 CONTROL
  0088          +1    27     CPT1CN         DATA 088H    ; COMPARATOR 1 CONTROL
  0088          +1    28     TCON           DATA 088H    ; TIMER/COUNTER CONTROL
  0089          +1    29     TMOD           DATA 089H    ; TIMER/COUNTER MODE
  0089          +1    30     CPT0MD         DATA 089H    ; COMPARATOR 0 CONFIGURATION
  0089          +1    31     CPT1MD         DATA 089H    ; COMPARATOR 1 CONFIGURATION
  0089          +1    32     PLL0CN         DATA 089H    ; PLL CONTROL
  008A          +1    33     OSCICN         DATA 08AH    ; INTERNAL OSCILLATOR CONTROL
  008A          +1    34     TL0            DATA 08AH    ; TIMER/COUNTER 0 LOW BYTE
  008B          +1    35     OSCICL         DATA 08BH    ; INTERNAL OSCILLATOR CALIBRATION
  008B          +1    36     TL1            DATA 08BH    ; TIMER/COUNTER 1 LOW BYTE
  008C          +1    37     OSCXCN         DATA 08CH    ; EXTERNAL OSCILLATOR CONTROL
  008C          +1    38     TH0            DATA 08CH    ; TIMER/COUNTER 0 HIGH BYTE
  008D          +1    39     TH1            DATA 08DH    ; TIMER/COUNTER 1 HIGH BYTE
  008D          +1    40     PLL0DIV        DATA 08DH    ; PLL DIVIDER
  008E          +1    41     CKCON          DATA 08EH    ; CLOCK CONTROL
  008E          +1    42     PLL0MUL        DATA 08EH    ; PLL MULTIPLIER
  008F          +1    43     PSCTL          DATA 08FH    ; FLASH WRITE/ERASE CONTROL
  008F          +1    44     PLL0FLT        DATA 08FH    ; PLL FILTER
  0090          +1    45     P1             DATA 090H    ; PORT 1 LATCH
  0091          +1    46     SSTA0          DATA 091H    ; UART 0 STATUS
  0091          +1    47     MAC0BL         DATA 091H    ; MAC0 B REGISTER LOW BYTE
  0092          +1    48     MAC0BH         DATA 092H    ; MAC0 B REGISTER HIGH BYTE
  0093          +1    49     MAC0ACC0       DATA 093H    ; MAC0 ACCUMULATOR BYTE 0
  0094          +1    50     MAC0ACC1       DATA 094H    ; MAC0 ACCUMULATOR BYTE 1
  0095          +1    51     MAC0ACC2       DATA 095H    ; MAC0 ACCUMULATOR BYTE 2
  0096          +1    52     SFRPGCN        DATA 096H    ; SFR PAGE CONTROL
  0096          +1    53     MAC0ACC3       DATA 096H    ; MAC0 ACCUMULATOR BYTE 3
  0097          +1    54     MAC0OVR        DATA 097H    ; MAC0 ACCUMULATOR OVERFLOW BYTE
  0097          +1    55     CLKSEL         DATA 097H    ; SYSTEM CLOCK SELECT
  0098          +1    56     SCON0          DATA 098H    ; UART 0 CONTROL
  0098          +1    57     SCON1          DATA 098H    ; UART 1 CONTROL
  0099          +1    58     SBUF0          DATA 099H    ; UART 0 DATA BUFFER
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     2

  0099          +1    59     SBUF1          DATA 099H    ; UART 1 DATA BUFFER
  009A          +1    60     SPI0CFG        DATA 09AH    ; SPI CONFIGURATION
  009A          +1    61     CCH0MA         DATA 09AH    ; CACHE MISS ACCUMULATOR
  009B          +1    62     SPI0DAT        DATA 09BH    ; SPI DATA
  009C          +1    63     P4MDOUT        DATA 09CH    ; PORT 4 OUTPUT MODE CONFIGURATION
  009D          +1    64     P5MDOUT        DATA 09DH    ; PORT 5 OUTPUT MODE CONFIGURATION
  009D          +1    65     SPI0CKR        DATA 09DH    ; SPI CLOCK RATE CONTROL
  009E          +1    66     P6MDOUT        DATA 09EH    ; PORT 6 OUTPUT MODE CONFIGURATION
  009F          +1    67     P7MDOUT        DATA 09FH    ; PORT 7 OUTPUT MODE CONFIGURATION
  00A0          +1    68     P2             DATA 0A0H    ; PORT 2 LATCH
  00A1          +1    69     EMI0TC         DATA 0A1H    ; EMIF TIMING CONTROL
  00A1          +1    70     CCH0CN         DATA 0A1H    ; CACHE CONTROL
  00A2          +1    71     EMI0CN         DATA 0A2H    ; EMIF CONTROL
  00A2          +1    72     CCH0TN         DATA 0A2H    ; CACHE TUNING
  00A3          +1    73     EMI0CF         DATA 0A3H    ; EMIF CONFIGURATION
  00A3          +1    74     CCH0LC         DATA 0A3H    ; CACHE LOCK
  00A4          +1    75     P0MDOUT        DATA 0A4H    ; PORT 0 OUTPUT MODE CONFIGURATION
  00A5          +1    76     P1MDOUT        DATA 0A5H    ; PORT 1 OUTPUT MODE CONFIGURATION
  00A6          +1    77     P2MDOUT        DATA 0A6H    ; PORT 2 OUTPUT MODE CONFIGURATION
  00A7          +1    78     P3MDOUT        DATA 0A7H    ; PORT 3 OUTPUT MODE CONFIGURATION
  00A8          +1    79     IE             DATA 0A8H    ; INTERRUPT ENABLE
  00A9          +1    80     SADDR0         DATA 0A9H    ; UART 0 SLAVE ADDRESS
  00AD          +1    81     P1MDIN         DATA 0ADH    ; PORT 1 INPUT MODE
  00B0          +1    82     P3             DATA 0B0H    ; PORT 3 LATCH
  00B1          +1    83     PSBANK         DATA 0B1H    ; FLASH BANK SELECT
  00B7          +1    84     FLACL          DATA 0B7H    ; FLASH ACCESS LIMIT
  00B7          +1    85     FLSCL          DATA 0B7H    ; FLASH SCALE
  00B8          +1    86     IP             DATA 0B8H    ; INTERRUPT PRIORITY
  00B9          +1    87     SADEN0         DATA 0B9H    ; UART 0 SLAVE ADDRESS MASK
  00BA          +1    88     AMX0CF         DATA 0BAH    ; ADC0 MULTIPLEXER CONFIGURATION
  00BA          +1    89     AMX2CF         DATA 0BAH    ; ADC2 MULTIPLEXER CONFIGURATION
  00BB          +1    90     AMX0SL         DATA 0BBH    ; ADC0 MULTIPLEXER CHANNEL SELECT
  00BB          +1    91     AMX2SL         DATA 0BBH    ; ADC2 MULTIPLEXER CHANNEL SELECT
  00BC          +1    92     ADC0CF         DATA 0BCH    ; ADC0 CONFIGURATION
  00BC          +1    93     ADC2CF         DATA 0BCH    ; ADC2 CONFIGURATION
  00BE          +1    94     ADC0L          DATA 0BEH    ; ADC0 DATA WORD LOW BYTE
  00BE          +1    95     ADC2           DATA 0BEH    ; ADC2DATA WORD
  00BF          +1    96     ADC0H          DATA 0BFH    ; ADC0 DATA WORD HIGH BYTE
  00C0          +1    97     MAC0STA        DATA 0C0H    ; MAC0 STATUS
  00C0          +1    98     SMB0CN         DATA 0C0H    ; SMBUS CONTROL
  00C1          +1    99     MAC0AL         DATA 0C1H    ; MAC0 A REGISTER LOW BYTE
  00C1          +1   100     SMB0STA        DATA 0C1H    ; SMBUS STATUS
  00C2          +1   101     MAC0AH         DATA 0C2H    ; MAC0 A REGISTER HIGH BYTE
  00C2          +1   102     SMB0DAT        DATA 0C2H    ; SMBUS DATA
  00C3          +1   103     MAC0CF         DATA 0C3H    ; MAC0 CONFIGURATION REGISTER
  00C3          +1   104     SMB0ADR        DATA 0C3H    ; SMBUS SLAVE ADDRESS
  00C4          +1   105     ADC0GTL        DATA 0C4H    ; ADC0 GREATER-THAN LOW BYTE
  00C4          +1   106     ADC2GT         DATA 0C4H    ; ADC2 GREATER-THAN
  00C5          +1   107     ADC0GTH        DATA 0C5H    ; ADC0 GREATER-THAN HIGH BYTE
  00C6          +1   108     ADC0LTL        DATA 0C6H    ; ADC0 LESS-THAN LOW BYTE
  00C6          +1   109     ADC2LT         DATA 0C6H    ; ADC2 LESS-THAN
  00C7          +1   110     ADC0LTH        DATA 0C7H    ; ADC0 LESS-THAN HIGH BYTE
  00C8          +1   111     P4             DATA 0C8H    ; PORT 4 LATCH
  00C8          +1   112     TMR2CN         DATA 0C8H    ; TIMER/COUNTER 2 CONTROL
  00C8          +1   113     TMR3CN         DATA 0C8H    ; TIMER 3 CONTROL
  00C8          +1   114     TMR4CN         DATA 0C8H    ; TIMER/COUNTER 4 CONTROL
  00C9          +1   115     TMR2CF         DATA 0C9H    ; TIMER/COUNTER 2 CONFIGURATION
  00C9          +1   116     TMR3CF         DATA 0C9H    ; TIMER 3 CONFIGURATION
  00C9          +1   117     TMR4CF         DATA 0C9H    ; TIMER/COUNTER 4 CONFIGURATION
  00CA          +1   118     RCAP2L         DATA 0CAH    ; TIMER/COUNTER 2 CAPTURE/RELOAD LOW BYTE
  00CA          +1   119     RCAP3L         DATA 0CAH    ; TIMER 3 CAPTURE/RELOAD LOW BYTE
  00CA          +1   120     RCAP4L         DATA 0CAH    ; TIMER/COUNTER 4 CAPTURE/RELOAD LOW BYTE
  00CB          +1   121     RCAP2H         DATA 0CBH    ; TIMER/COUNTER 2 CAPTURE/RELOAD HIGH BYTE
  00CB          +1   122     RCAP3H         DATA 0CBH    ; TIMER 3 CAPTURE/RELOAD HIGH BYTE
  00CB          +1   123     RCAP4H         DATA 0CBH    ; TIMER/COUNTER 4 CAPTURE/RELOAD HIGH BYTE
  00CC          +1   124     TMR2L          DATA 0CCH    ; TIMER/COUNTER 2 LOW BYTE
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     3

  00CC          +1   125     TMR3L          DATA 0CCH    ; TIMER 3 LOW BYTE
  00CC          +1   126     TMR4L          DATA 0CCH    ; TIMER/COUNTER 4 LOW BYTE
  00CD          +1   127     TMR2H          DATA 0CDH    ; TIMER/COUNTER 2 HIGH BYTE
  00CD          +1   128     TMR3H          DATA 0CDH    ; TIMER 3 HIGH BYTE
  00CD          +1   129     TMR4H          DATA 0CDH    ; TIMER/COUNTER 4 HIGH BYTE
  00CE          +1   130     MAC0RNDL       DATA 0CEH    ; MAC0 ROUNDING REGISTER LOW BYTE
  00CF          +1   131     MAC0RNDH       DATA 0CFH    ; MAC0 ROUNDING REGISTER HIGH BYTE
  00CF          +1   132     SMB0CR         DATA 0CFH    ; SMBUS CLOCK RATE
  00D0          +1   133     PSW            DATA 0D0H    ; PROGRAM STATUS WORD
  00D1          +1   134     REF0CN         DATA 0D1H    ; VOLTAGE REFERENCE CONTROL
  00D2          +1   135     DAC0L          DATA 0D2H    ; DAC0 LOW BYTE
  00D2          +1   136     DAC1L          DATA 0D2H    ; DAC1 LOW BYTE
  00D3          +1   137     DAC0H          DATA 0D3H    ; DAC0 HIGH BYTE
  00D3          +1   138     DAC1H          DATA 0D3H    ; DAC1 HIGH BYTE
  00D4          +1   139     DAC0CN         DATA 0D4H    ; DAC0 CONTROL
  00D4          +1   140     DAC1CN         DATA 0D4H    ; DAC1 CONTROL
  00D8          +1   141     P5             DATA 0D8H    ; PORT 5 LATCH
  00D8          +1   142     PCA0CN         DATA 0D8H    ; PCA CONTROL
  00D9          +1   143     PCA0MD         DATA 0D9H    ; PCA MODE
  00DA          +1   144     PCA0CPM0       DATA 0DAH    ; PCA MODULE 0 MODE
  00DB          +1   145     PCA0CPM1       DATA 0DBH    ; PCA MODULE 1 MODE REGISTER
  00DC          +1   146     PCA0CPM2       DATA 0DCH    ; PCA MODULE 2 MODE
  00DD          +1   147     PCA0CPM3       DATA 0DDH    ; PCA MODULE 3 MODE
  00DE          +1   148     PCA0CPM4       DATA 0DEH    ; PCA MODULE 4 MODE
  00DF          +1   149     PCA0CPM5       DATA 0DFH    ; PCA MODULE 5 MODE
  00E0          +1   150     ACC            DATA 0E0H    ; ACCUMULATOR
  00E1          +1   151     XBR0           DATA 0E1H    ; PORT I/O CROSSBAR CONTROL 0
  00E1          +1   152     PCA0CPL5       DATA 0E1H    ; PCA MODULE 5 CAPTURE/COMPARE LOW BYTE
  00E2          +1   153     PCA0CPH5       DATA 0E2H    ; PCA MODULE 5 CAPTURE/COMPARE HIGH BYTE
  00E2          +1   154     XBR1           DATA 0E2H    ; PORT I/O CROSSBAR CONTROL 1
  00E3          +1   155     XBR2           DATA 0E3H    ; PORT I/O CROSSBAR CONTROL 2
  00E6          +1   156     EIE1           DATA 0E6H    ; EXTENDED INTERRUPT ENABLE 1
  00E7          +1   157     EIE2           DATA 0E7H    ; EXTENDED INTERRUPT ENABLE 2
  00E8          +1   158     ADC0CN         DATA 0E8H    ; ADC0 CONTROL
  00E8          +1   159     ADC2CN         DATA 0E8H    ; ADC2 CONTROL
  00E8          +1   160     P6             DATA 0E8H    ; PORT 6 LATCH
  00E9          +1   161     PCA0CPL2       DATA 0E9H    ; PCA MODULE 2 CAPTURE/COMPARE LOW BYTE
  00EA          +1   162     PCA0CPH2       DATA 0EAH    ; PCA MODULE 2 CAPTURE/COMPARE HIGH BYTE
  00EB          +1   163     PCA0CPL3       DATA 0EBH    ; PCA MODULE 3 CAPTURE/COMPARE LOW BYTE
  00EC          +1   164     PCA0CPH3       DATA 0ECH    ; PCA MODULE 3 CAPTURE/COMPARE HIGH BYTE
  00ED          +1   165     PCA0CPL4       DATA 0EDH    ; PCA MODULE 4 CAPTURE/COMPARE LOW BYTE
  00EE          +1   166     PCA0CPH4       DATA 0EEH    ; PCA MODULE 4 CAPTURE/COMPARE HIGH BYTE
  00EF          +1   167     RSTSRC         DATA 0EFH    ; RESET SOURCE
  00F0          +1   168     B              DATA 0F0H    ; B REGISTER
  00F6          +1   169     EIP1           DATA 0F6H    ; EXTERNAL INTERRUPT PRIORITY 1
  00F7          +1   170     EIP2           DATA 0F7H    ; EXTERNAL INTERRUPT PRIORITY 2
  00F8          +1   171     P7             DATA 0F8H    ; PORT 7 LATCH
  00F8          +1   172     SPI0CN         DATA 0F8H    ; SPI CONTROL
  00F9          +1   173     PCA0L          DATA 0F9H    ; PCA COUNTER LOW BYTE
  00FA          +1   174     PCA0H          DATA 0FAH    ; PCA COUNTER HIGH BYTE
  00FB          +1   175     PCA0CPL0       DATA 0FBH    ; PCA MODULE 0 CAPTURE/COMPARE LOW BYTE
  00FC          +1   176     PCA0CPH0       DATA 0FCH    ; PCA MODULE 0 CAPTURE/COMPARE HIGH BYTE
  00FD          +1   177     PCA0CPL1       DATA 0FDH    ; PCA MODULE 1 CAPTURE/COMPARE LOW BYTE
  00FE          +1   178     PCA0CPH1       DATA 0FEH    ; PCA MODULE 1 CAPTURE/COMPARE HIGH BYTE
  00FF          +1   179     WDTCN          DATA 0FFH    ; WATCHDOG TIMER CONTROL
                +1   180     
                +1   181     ;
                +1   182     ;------------------------------------------------------------------------------
                +1   183     ;BIT DEFINITIONS
                +1   184     ;
                +1   185     ; TCON 088H
  008F          +1   186     TF1            BIT 08FH     ; TIMER 1 OVERFLOW FLAG
  008E          +1   187     TR1            BIT 08EH     ; TIMER 1 ON/OFF CONTROL
  008D          +1   188     TF0            BIT 08DH     ; TIMER 0 OVERFLOW FLAG
  008C          +1   189     TR0            BIT 08CH     ; TIMER 0 ON/OFF CONTROL
  008B          +1   190     IE1            BIT 08BH     ; EXT. INTERRUPT 1 EDGE FLAG
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     4

  008A          +1   191     IT1            BIT 08AH     ; EXT. INTERRUPT 1 TYPE
  0089          +1   192     IE0            BIT 089H     ; EXT. INTERRUPT 0 EDGE FLAG
  0088          +1   193     IT0            BIT 088H     ; EXT. INTERRUPT 0 TYPE
                +1   194     
                +1   195     ; CPT0CN 088H
  008F          +1   196     CP0EN          BIT 08FH     ; COMPARATOR 0 ENABLE
  008E          +1   197     CP0OUT         BIT 08EH     ; COMPARATOR 0 OUTPUT
  008D          +1   198     CP0RIF         BIT 08DH     ; COMPARATOR 0 RISING EDGE INTERRUPT
  008C          +1   199     CP0FIF         BIT 08CH     ; COMPARATOR 0 FALLING EDGE INTERRUPT
  008B          +1   200     CP0HYP1        BIT 08BH     ; COMPARATOR 0 POSITIVE HYSTERISIS 1
  008A          +1   201     CP0HYP0        BIT 08AH     ; COMPARATOR 0 POSITIVE HYSTERISIS 0
  0089          +1   202     CP0HYN1        BIT 089H     ; COMPARATOR 0 NEGATIVE HYSTERISIS 1
  0088          +1   203     CP0HYN0        BIT 088H     ; COMPARATOR 0 NEGATIVE HYSTERISIS 0
                +1   204     
                +1   205     ; CPT1CN 088H
  008F          +1   206     CP1EN          BIT 08FH     ; COMPARATOR 1 ENABLE
  008E          +1   207     CP1OUT         BIT 08EH     ; COMPARATOR 1 OUTPUT
  008D          +1   208     CP1RIF         BIT 08DH     ; COMPARATOR 1 RISING EDGE INTERRUPT
  008C          +1   209     CP1FIF         BIT 08CH     ; COMPARATOR 1 FALLING EDGE INTERRUPT
  008B          +1   210     CP1HYP1        BIT 08BH     ; COMPARATOR 1 POSITIVE HYSTERISIS 1
  008A          +1   211     CP1HYP0        BIT 08AH     ; COMPARATOR 1 POSITIVE HYSTERISIS 0
  0089          +1   212     CP1HYN1        BIT 089H     ; COMPARATOR 1 NEGATIVE HYSTERISIS 1
  0088          +1   213     CP1HYN0        BIT 088H     ; COMPARATOR 1 NEGATIVE HYSTERISIS 0
                +1   214     
                +1   215     ; FLSTAT 088H
  0088          +1   216     FLHBUSY        BIT 088H     ; FLASH BUSY
                +1   217     
                +1   218     ; SCON0 098H
  009F          +1   219     SM00           BIT 09FH     ; UART 0 MODE 0
  009E          +1   220     SM10           BIT 09EH     ; UART 0 MODE 1
  009D          +1   221     SM20           BIT 09DH     ; UART 0 MULTIPROCESSOR EN
  009C          +1   222     REN0           BIT 09CH     ; UART 0 RX ENABLE
  009B          +1   223     TB80           BIT 09BH     ; UART 0 TX BIT 8
  009A          +1   224     RB80           BIT 09AH     ; UART 0 RX BIT 8
  0099          +1   225     TI0            BIT 099H     ; UART 0 TX INTERRUPT FLAG
  0098          +1   226     RI0            BIT 098H     ; UART 0 RX INTERRUPT FLAG
                +1   227     
                +1   228     ; SCON1 098H
  009F          +1   229     S1MODE         BIT 09FH     ; UART 1 MODE
  009D          +1   230     MCE1           BIT 09DH     ; UART 1 MCE
  009C          +1   231     REN1           BIT 09CH     ; UART 1 RX ENABLE
  009B          +1   232     TB81           BIT 09BH     ; UART 1 TX BIT 8
  009A          +1   233     RB81           BIT 09AH     ; UART 1 RX BIT 8
  0099          +1   234     TI1            BIT 099H     ; UART 1 TX INTERRUPT FLAG
  0098          +1   235     RI1            BIT 098H     ; UART 1 RX INTERRUPT FLAG
                +1   236     
                +1   237     ; IE 0A8H
  00AF          +1   238     EA             BIT 0AFH     ; GLOBAL INTERRUPT ENABLE
  00AD          +1   239     ET2            BIT 0ADH     ; TIMER 2 INTERRUPT ENABLE
  00AC          +1   240     ES0            BIT 0ACH     ; UART0 INTERRUPT ENABLE
  00AB          +1   241     ET1            BIT 0ABH     ; TIMER 1 INTERRUPT ENABLE
  00AA          +1   242     EX1            BIT 0AAH     ; EXTERNAL INTERRUPT 1 ENABLE
  00A9          +1   243     ET0            BIT 0A9H     ; TIMER 0 INTERRUPT ENABLE
  00A8          +1   244     EX0            BIT 0A8H     ; EXTERNAL INTERRUPT 0 ENABLE
                +1   245     
                +1   246     ; IP 0B8H
  00BD          +1   247     PT2            BIT 0BDH     ; TIMER 2 PRIORITY
  00BC          +1   248     PS             BIT 0BCH     ; SERIAL PORT PRIORITY
  00BB          +1   249     PT1            BIT 0BBH     ; TIMER 1 PRIORITY
  00BA          +1   250     PX1            BIT 0BAH     ; EXTERNAL INTERRUPT 1 PRIORITY
  00B9          +1   251     PT0            BIT 0B9H     ; TIMER 0 PRIORITY
  00B8          +1   252     PX0            BIT 0B8H     ; EXTERNAL INTERRUPT 0 PRIORITY
                +1   253     
                +1   254     ; SMB0CN 0C0H
  00C7          +1   255     BUSY           BIT 0C7H     ; SMBUS 0 BUSY
  00C6          +1   256     ENSMB          BIT 0C6H     ; SMBUS 0 ENABLE
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     5

  00C5          +1   257     STA            BIT 0C5H     ; SMBUS 0 START FLAG
  00C4          +1   258     STO            BIT 0C4H     ; SMBUS 0 STOP FLAG
  00C3          +1   259     SI             BIT 0C3H     ; SMBUS 0 INTERRUPT PENDING FLAG
  00C2          +1   260     AA             BIT 0C2H     ; SMBUS 0 ASSERT/ACKNOWLEDGE FLAG
  00C1          +1   261     SMBFTE         BIT 0C1H     ; SMBUS 0 FREE TIMER ENABLE
  00C0          +1   262     SMBTOE         BIT 0C0H     ; SMBUS 0 TIMEOUT ENABLE
                +1   263     
                +1   264     ; MAC0STA 0C0H
  00C3          +1   265     MAC0HO         BIT 0C3H     ; MAC0 HARD OVERFLOW
  00C2          +1   266     MAC0Z          BIT 0C2H     ; MAC0 ZERO
  00C1          +1   267     MAC0SO         BIT 0C1H     ; MAC0 SOFT OVERFLOW
  00C0          +1   268     MAC0N          BIT 0C0H     ; MAC0 NEGATIVE
                +1   269     
                +1   270     ; TMR2CN 0C8H
  00CF          +1   271     TF2            BIT 0CFH     ; TIMER 2 OVERFLOW FLAG
  00CE          +1   272     EXF2           BIT 0CEH     ; TIMER 2 EXTERNAL FLAG
  00CB          +1   273     EXEN2          BIT 0CBH     ; TIMER 2 EXTERNAL ENABLE FLAG
  00CA          +1   274     TR2            BIT 0CAH     ; TIMER 2 ON/OFF CONTROL
  00C9          +1   275     CT2            BIT 0C9H     ; TIMER 2 COUNTER SELECT
  00C8          +1   276     CPRL2          BIT 0C8H     ; TIMER 2 CAPTURE SELECT
                +1   277     
                +1   278     ; TMR3CN 0C8H
  00CF          +1   279     TF3            BIT 0CFH     ; TIMER 3 OVERFLOW FLAG
  00CE          +1   280     EXF3           BIT 0CEH     ; TIMER 3 EXTERNAL FLAG
  00CB          +1   281     EXEN3          BIT 0CBH     ; TIMER 3 EXTERNAL ENABLE FLAG
  00CA          +1   282     TR3            BIT 0CAH     ; TIMER 3 ON/OFF CONTROL
  00C9          +1   283     CT3            BIT 0C9H     ; TIMER 3 COUNTER SELECT
  00C8          +1   284     CPRL3          BIT 0C8H     ; TIMER 3 CAPTURE SELECT
                +1   285     
                +1   286     ; TMR4CN 0C8H
  00CF          +1   287     TF4            BIT 0CFH     ; TIMER 4 OVERFLOW FLAG
  00CE          +1   288     EXF4           BIT 0CEH     ; TIMER 4 EXTERNAL FLAG
  00CB          +1   289     EXEN4          BIT 0CBH     ; TIMER 4 EXTERNAL ENABLE FLAG
  00CA          +1   290     TR4            BIT 0CAH     ; TIMER 4 ON/OFF CONTROL
  00C9          +1   291     CT4            BIT 0C9H     ; TIMER 4 COUNTER SELECT
  00C8          +1   292     CPRL4          BIT 0C8H     ; TIMER 4 CAPTURE SELECT
                +1   293     
                +1   294     ; PSW 0D0H
  00D7          +1   295     CY             BIT 0D7H     ; CARRY FLAG
  00D6          +1   296     AC             BIT 0D6H     ; AUXILIARY CARRY FLAG
  00D5          +1   297     F0             BIT 0D5H     ; USER FLAG 0
  00D4          +1   298     RS1            BIT 0D4H     ; REGISTER BANK SELECT 1
  00D3          +1   299     RS0            BIT 0D3H     ; REGISTER BANK SELECT 0
  00D2          +1   300     OV             BIT 0D2H     ; OVERFLOW FLAG
  00D1          +1   301     F1             BIT 0D1H     ; USER FLAG 1
  00D0          +1   302     P              BIT 0D0H     ; ACCUMULATOR PARITY FLAG
                +1   303     
                +1   304     ; PCA0CN 0D8H
  00DF          +1   305     CF             BIT 0DFH     ; PCA 0 COUNTER OVERFLOW FLAG
  00DE          +1   306     CR             BIT 0DEH     ; PCA 0 COUNTER RUN CONTROL BIT
  00DD          +1   307     CCF5           BIT 0DDH     ; PCA 0 MODULE 5 INTERRUPT FLAG
  00DC          +1   308     CCF4           BIT 0DCH     ; PCA 0 MODULE 4 INTERRUPT FLAG
  00DB          +1   309     CCF3           BIT 0DBH     ; PCA 0 MODULE 3 INTERRUPT FLAG
  00DA          +1   310     CCF2           BIT 0DAH     ; PCA 0 MODULE 2 INTERRUPT FLAG
  00D9          +1   311     CCF1           BIT 0D9H     ; PCA 0 MODULE 1 INTERRUPT FLAG
  00D8          +1   312     CCF0           BIT 0D8H     ; PCA 0 MODULE 0 INTERRUPT FLAG
                +1   313     
                +1   314     ; ADC0CN 0E8H
  00EF          +1   315     AD0EN          BIT 0EFH     ; ADC 0 ENABLE
  00EE          +1   316     AD0TM          BIT 0EEH     ; ADC 0 TRACK MODE
  00ED          +1   317     AD0INT         BIT 0EDH     ; ADC 0 EOC INTERRUPT FLAG
  00EC          +1   318     AD0BUSY        BIT 0ECH     ; ADC 0 BUSY FLAG
  00EB          +1   319     AD0CM1         BIT 0EBH     ; ADC 0 CONVERT START MODE BIT 1
  00EA          +1   320     AD0CM0         BIT 0EAH     ; ADC 0 CONVERT START MODE BIT 0
  00E9          +1   321     AD0WINT        BIT 0E9H     ; ADC 0 WINDOW INTERRUPT FLAG
  00E8          +1   322     AD0LJST        BIT 0E8H     ; ADC 0 LEFT JUSTIFY DATA BIT
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     6

                +1   323     
                +1   324     ; ADC2CN 0E8H
  00EF          +1   325     AD2EN          BIT 0EFH     ; ADC 2 ENABLE
  00EE          +1   326     AD2TM          BIT 0EEH     ; ADC 2 TRACK MODE
  00ED          +1   327     AD2INT         BIT 0EDH     ; ADC 2 EOC INTERRUPT FLAG
  00EC          +1   328     AD2BUSY        BIT 0ECH     ; ADC 2 BUSY FLAG
  00EB          +1   329     AD2CM2         BIT 0EBH     ; ADC 2 CONVERT START MODE BIT 2
  00EA          +1   330     AD2CM1         BIT 0EAH     ; ADC 2 CONVERT START MODE BIT 1
  00E9          +1   331     AD2CM0         BIT 0E9H     ; ADC 2 CONVERT START MODE BIT 0
  00E8          +1   332     AD2WINT        BIT 0E8H     ; ADC 2 WINDOW INTERRUPT FLAG
                +1   333     
                +1   334     ; SPI0CN 0F8H
  00FF          +1   335     SPIF           BIT 0FFH     ; SPI 0 INTERRUPT FLAG
  00FE          +1   336     WCOL           BIT 0FEH     ; SPI 0 WRITE COLLISION FLAG
  00FD          +1   337     MODF           BIT 0FDH     ; SPI 0 MODE FAULT FLAG
  00FC          +1   338     RXOVRN         BIT 0FCH     ; SPI 0 RX OVERRUN FLAG
  00FB          +1   339     NSSMD1         BIT 0FBH     ; SPI 0 SLAVE SELECT MODE 1
  00FA          +1   340     NSSMD0         BIT 0FAH     ; SPI 0 SLAVE SELECT MODE 0
  00F9          +1   341     TXBMT          BIT 0F9H     ; SPI 0 TX BUFFER EMPTY FLAG
  00F8          +1   342     SPIEN          BIT 0F8H     ; SPI 0 SPI ENABLE
                +1   343     
                +1   344     ;
                +1   345     ;------------------------------------------------------------------------------
                +1   346     ; SFR PAGE DEFINITIONS
                +1   347     ;
  000F          +1   348     CONFIG_PAGE                 EQU 0FH   ; SYSTEM AND PORT CONFIGURATION PAGE
  0000          +1   349     LEGACY_PAGE                 EQU 00H   ; LEGACY SFR PAGE
  0000          +1   350     TIMER01_PAGE                EQU 00H   ; TIMER 0 AND TIMER 1
  0001          +1   351     CPT0_PAGE                   EQU 01H   ; COMPARATOR 0
  0002          +1   352     CPT1_PAGE                   EQU 02H   ; COMPARATOR 1
  0000          +1   353     UART0_PAGE                  EQU 00H   ; UART 0
  0001          +1   354     UART1_PAGE                  EQU 01H   ; UART 1
  0000          +1   355     SPI0_PAGE                   EQU 00H   ; SPI 0
  0000          +1   356     EMI0_PAGE                   EQU 00H   ; EXTERNAL MEMORY INTERFACE
  0000          +1   357     ADC0_PAGE                   EQU 00H   ; ADC 0
  0002          +1   358     ADC2_PAGE                   EQU 02H   ; ADC 2
  0000          +1   359     SMB0_PAGE                   EQU 00H   ; SMBUS 0
  0000          +1   360     TMR2_PAGE                   EQU 00H   ; TIMER 2
  0001          +1   361     TMR3_PAGE                   EQU 01H   ; TIMER 3
  0002          +1   362     TMR4_PAGE                   EQU 02H   ; TIMER 4
  0000          +1   363     DAC0_PAGE                   EQU 00H   ; DAC 0
  0001          +1   364     DAC1_PAGE                   EQU 01H   ; DAC 1
  0000          +1   365     PCA0_PAGE                   EQU 00H   ; PCA 0
  000F          +1   366     PLL0_PAGE                   EQU 0FH   ; PLL 0
  0003          +1   367     MAC0_PAGE                   EQU 03H   ; MAC 0
                     368     
                     369             
----                 370     CSEG AT 0
                     371     
0000 C2AF            372             CLR EA                                  ; Запретить все прерывания
0002 75FFDE          373             MOV WDTCN,              #0xDE   ; Отключить строковый таймер
0005 75FFAD          374             MOV WDTCN,              #0xAD   ; Отключить сторожевой таймер
0008 75840F          375             MOV SFRPAGE,    #0x0F   ; Выбрать страницу "F" 
000B 759600          376             MOV SFRPGCN,    #0x00   ; Запретить автоматическое переключение страниц ("SFRPGCN" 
                             стр. "F")
000E 758A83          377             MOV OSCICN,             #0x83   ; Внутренний генератор включения, частота 24,5 MГц 
                             (OSCICN" стр. "F")
                     378     ;------------------------------------------------------------------------------------------
                             ---
                     379     
                     380     ;0. Настраиваем все пины.
0011 758400          381             MOV             SFRPAGE,        #0x00           ;Стр. "0".
                     382             
0014 759D01          383             MOV             SPI0CKR,        #1                      
0017 759A40          384             MOV             SPI0CFG,        #01000000b      ;Включаем ведущий режим.
001A 75F801          385             MOV             SPI0CN,         #00000001b      ;Включаем модуль SPI0.
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     7

                     386             
001D 75840F          387             MOV             SFRPAGE,        #0x0F           ;Стр. "F".
0020 75A40D          388             MOV             P0MDOUT,        #00001101b      ;Тут 3 пин является NSS.
0023 7580FF          389             MOV             P0,                     #11111111b
                     390     
0026 75A601          391             MOV             P2MDOUT,        #00000001b      ;Пин RSTN, пока непонятно зачем.
0029 75A0FF          392             MOV             P2,                     #11111111b
                     393     
                     394     ;0. Подключаем пины к матрице.
002C 75E102          395             MOV             XBR0,           #00000010b
002F 75E340          396             MOV             XBR2,           #01000000b
                     397             
0032 758400          398             MOV             SFRPAGE,        #0x00                   
0035 7910            399             MOV             R1,                     #0x10
                     400     
                     401     ;00. Я так понимаю, неплохо было бы сбросить перед всеми процедурами контроллер.
0037 C2A0            402             CLR             PIN_RSTN
0039 B12C            403             ACALL   Wait_long
003B D2A0            404             SETB    PIN_RSTN
                     405     
003D B12C            406             ACALL   Wait_long               ;Теперь ждем, пока напряжение появится.
                     407     
                     408     
                     409     ;1. Будем настраивать Common Register Block.
                     410     ;1.1. Настраиваем регистр MR.
003F C283            411             CLR             P0.3
0041 B127            412             ACALL   Wait_short
                     413             
0043 E4              414             CLR             A
0044 B141            415             ACALL   SPI0_W
                     416     ;Пусть нашей жертвой будет регистр MR. Он имеет смещение 0x0000.
0046 7400            417             MOV             A,              #MR
0048 B141            418             ACALL   SPI0_W
                     419     ;Дальше передаем Control Phase. В нашем случае 0x00 (согласно стр. 29), 1 (т.е. write), 00.
004A 7404            420             MOV             A,              #00000100b
004C B141            421             ACALL   SPI0_W
                     422     ;Ну и сами данные.
004E 7480            423             MOV             A,              #10000000b
0050 B141            424             ACALL   SPI0_W
                     425             
0052 D283            426             SETB    P0.3
0054 B127            427             ACALL   Wait_short
                     428     
                     429     ;1.2. Настраиваем регистр GAR.
0056 C283            430             CLR             P0.3
0058 B127            431             ACALL   Wait_short
                     432             
005A E4              433             CLR             A
005B B141            434             ACALL   SPI0_W
                     435     
005D 7401            436             MOV             A,              #GAR1
005F B141            437             ACALL   SPI0_W
                     438     
0061 7404            439             MOV             A,              #00000100b
0063 B141            440             ACALL   SPI0_W
                     441     
0065 74C0            442             MOV             A,              #0xC0
0067 B141            443             ACALL   SPI0_W
                     444             
0069 74A8            445             MOV             A,              #0xA8
006B B141            446             ACALL   SPI0_W
                     447             
006D 7414            448             MOV             A,              #0x14
006F B141            449             ACALL   SPI0_W
                     450             
0071 7400            451             MOV             A,              #0x00
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     8

0073 B141            452             ACALL   SPI0_W
                     453             
0075 D283            454             SETB    P0.3
0077 B127            455             ACALL   Wait_short
                     456     
                     457     
                     458     ;1.3. Настраиваем регистр SUBR.
0079 C283            459             CLR             P0.3
007B B127            460             ACALL   Wait_short
                     461             
007D E4              462             CLR             A
007E B141            463             ACALL   SPI0_W
                     464     
0080 7405            465             MOV             A,              #SUBR1
0082 B141            466             ACALL   SPI0_W
                     467     
0084 7404            468             MOV             A,              #00000100b
0086 B141            469             ACALL   SPI0_W
                     470     
0088 74FF            471             MOV             A,              #0xFF
008A B141            472             ACALL   SPI0_W
                     473             
008C 74FF            474             MOV             A,              #0xFF
008E B141            475             ACALL   SPI0_W
                     476             
0090 74FF            477             MOV             A,              #0xFF
0092 B141            478             ACALL   SPI0_W
                     479             
0094 7400            480             MOV             A,              #0x00
0096 B141            481             ACALL   SPI0_W
                     482             
0098 D283            483             SETB    P0.3
009A B127            484             ACALL   Wait_short
                     485     
                     486     
                     487     ;1.4. Настраиваем регистр SHAR.
009C C283            488             CLR             P0.3
009E B127            489             ACALL   Wait_short
                     490             
00A0 E4              491             CLR             A
00A1 B141            492             ACALL   SPI0_W
                     493     
00A3 7409            494             MOV             A,              #SHAR1
00A5 B141            495             ACALL   SPI0_W
                     496     
00A7 7404            497             MOV             A,              #00000100b
00A9 B141            498             ACALL   SPI0_W
                     499     
00AB 7470            500             MOV             A,              #0x70
00AD B141            501             ACALL   SPI0_W
                     502             
00AF 74FF            503             MOV             A,              #0xFF
00B1 B141            504             ACALL   SPI0_W
                     505             
00B3 7476            506             MOV             A,              #0x76
00B5 B141            507             ACALL   SPI0_W
                     508             
00B7 741C            509             MOV             A,              #0x1C
00B9 B141            510             ACALL   SPI0_W
                     511             
00BB 74C0            512             MOV             A,              #0xC0
00BD B141            513             ACALL   SPI0_W
                     514             
00BF 7467            515             MOV             A,              #0x67
00C1 B141            516             ACALL   SPI0_W
                     517             
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE     9

00C3 D283            518             SETB    P0.3
00C5 B127            519             ACALL   Wait_short
                     520     
                     521     
                     522     ;1.5. Настраиваем регистр SIPR.
00C7 C283            523             CLR             P0.3
00C9 B127            524             ACALL   Wait_short
                     525             
00CB E4              526             CLR             A
00CC B141            527             ACALL   SPI0_W
                     528     
00CE 740F            529             MOV             A,              #SIPR1
00D0 B141            530             ACALL   SPI0_W
                     531     
00D2 7404            532             MOV             A,              #00000100b
00D4 B141            533             ACALL   SPI0_W
                     534     
00D6 74C0            535             MOV             A,              #0xC0
00D8 B141            536             ACALL   SPI0_W
                     537             
00DA 74A8            538             MOV             A,              #0xA8
00DC B141            539             ACALL   SPI0_W
                     540             
00DE 7414            541             MOV             A,              #0x14
00E0 B141            542             ACALL   SPI0_W
                     543             
00E2 7401            544             MOV             A,              #0x01
00E4 B141            545             ACALL   SPI0_W
                     546             
00E6 D283            547             SETB    P0.3
00E8 B127            548             ACALL   Wait_short
                     549     
                     550     
                     551     ;1.6. Настраиваем регистр RTR.
00EA C283            552             CLR             P0.3
00EC B127            553             ACALL   Wait_short
                     554             
00EE E4              555             CLR             A
00EF B141            556             ACALL   SPI0_W
                     557     
00F1 7419            558             MOV             A,              #RTR1
00F3 B141            559             ACALL   SPI0_W
                     560     
00F5 7404            561             MOV             A,              #00000100b
00F7 B141            562             ACALL   SPI0_W
                     563     
00F9 7407            564             MOV             A,              #0x07
00FB B141            565             ACALL   SPI0_W
                     566             
00FD 74D0            567             MOV             A,              #0xD0
00FF B141            568             ACALL   SPI0_W
                     569             
0101 D283            570             SETB    P0.3
0103 B127            571             ACALL   Wait_short
                     572     
                     573     
                     574     ;1.7. Настраиваем регистр RCR.
0105 C283            575             CLR             P0.3
0107 B127            576             ACALL   Wait_short
                     577             
0109 E4              578             CLR             A
010A B141            579             ACALL   SPI0_W
                     580     
010C 741B            581             MOV             A,              #RCR1
010E B141            582             ACALL   SPI0_W
                     583     
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    10

0110 7404            584             MOV             A,              #00000100b
0112 B141            585             ACALL   SPI0_W
                     586     
0114 740A            587             MOV             A,              #0x0A
0116 B141            588             ACALL   SPI0_W
                     589             
0118 D283            590             SETB    P0.3
011A B127            591             ACALL   Wait_short
                     592     ;-------------------------------------------------------------
                     593     
                     594     
                     595     ;2. Делаем общие настройки 1 сокета и некоторые настройки других сокетов.
                     596     ;2.1. Настраиваем регистр S1_MR.
011C C283            597             CLR             P0.3
011E B127            598             ACALL   Wait_short
                     599             
0120 E4              600             CLR             A
0121 B141            601             ACALL   SPI0_W
                     602     
0123 7400            603             MOV             A,              #S1_MR
0125 B141            604             ACALL   SPI0_W
                     605     
0127 742C            606             MOV             A,              #00101100b
0129 B141            607             ACALL   SPI0_W
                     608     
012B 7442            609             MOV             A,              #01000010b
012D B141            610             ACALL   SPI0_W
                     611             
012F D283            612             SETB    P0.3
0131 B127            613             ACALL   Wait_short
                     614     
                     615     ;2.2. Настраиваем регистр S1_PORT.
0133 C283            616             CLR             P0.3
0135 B127            617             ACALL   Wait_short
                     618             
0137 E4              619             CLR             A
0138 B141            620             ACALL   SPI0_W
                     621     
013A 7404            622             MOV             A,              #S1_PORT
013C B141            623             ACALL   SPI0_W
                     624     
013E 742C            625             MOV             A,              #00101100b
0140 B141            626             ACALL   SPI0_W
                     627     
0142 7408            628             MOV             A,              #0x08
0144 B141            629             ACALL   SPI0_W
                     630             
0146 7434            631             MOV             A,              #0x34
0148 B141            632             ACALL   SPI0_W
                     633             
014A D283            634             SETB    P0.3
014C B127            635             ACALL   Wait_short
                     636     
                     637     ;2.3. Настраиваем регистр S1_TTL.
014E C283            638             CLR             P0.3
0150 B127            639             ACALL   Wait_short
                     640             
0152 E4              641             CLR             A
0153 B141            642             ACALL   SPI0_W
                     643     
0155 7416            644             MOV             A,              #S1_TTL
0157 B141            645             ACALL   SPI0_W
                     646     
0159 742C            647             MOV             A,              #00101100b
015B B141            648             ACALL   SPI0_W
                     649     
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    11

015D 7410            650             MOV             A,              #0x10
015F B141            651             ACALL   SPI0_W
                     652             
0161 D283            653             SETB    P0.3
0163 B127            654             ACALL   Wait_short
                     655             
                     656     ;2.4. Настраиваем регистр S1_RXBUF_SIZE.
0165 C283            657             CLR             P0.3
0167 B127            658             ACALL   Wait_short
                     659             
0169 E4              660             CLR             A
016A B141            661             ACALL   SPI0_W
                     662     
016C 741E            663             MOV             A,              #S1_RXBUF_SIZE
016E B141            664             ACALL   SPI0_W
                     665     
0170 742C            666             MOV             A,              #00101100b
0172 B141            667             ACALL   SPI0_W
                     668     
0174 7404            669             MOV             A,              #0x04
0176 B141            670             ACALL   SPI0_W
                     671             
0178 D283            672             SETB    P0.3
017A B127            673             ACALL   Wait_short
                     674             
                     675     ;2.5. Настраиваем регистр S1_TXBUF_SIZE.
017C C283            676             CLR             P0.3
017E B127            677             ACALL   Wait_short
                     678             
0180 E4              679             CLR             A
0181 B141            680             ACALL   SPI0_W
                     681     
0183 741F            682             MOV             A,              #S1_TXBUF_SIZE
0185 B141            683             ACALL   SPI0_W
                     684     
0187 742C            685             MOV             A,              #00101100b
0189 B141            686             ACALL   SPI0_W
                     687     
018B 7402            688             MOV             A,              #0x02
018D B141            689             ACALL   SPI0_W
                     690                     
018F D283            691             SETB    P0.3
0191 B127            692             ACALL   Wait_short
                     693     ;----------------------------------------------------------------
                     694     
                     695     ;----------------------------------------------------------------
                     696     
                     697     
                     698     ;3. А теперь настроим размеры буферов для остальных сокетов.
                     699     ;3.1.1. Настраиваем регистр S0_RXBUF_SIZE.
0193 C283            700             CLR             P0.3
0195 B127            701             ACALL   Wait_short
                     702             
0197 E4              703             CLR             A
0198 B141            704             ACALL   SPI0_W
                     705     
019A 741E            706             MOV             A,              #S1_RXBUF_SIZE
019C B141            707             ACALL   SPI0_W
                     708     
019E 740C            709             MOV             A,              #00001100b
01A0 B141            710             ACALL   SPI0_W
                     711     
01A2 7400            712             MOV             A,              #0x00
01A4 B141            713             ACALL   SPI0_W
                     714             
01A6 D283            715             SETB    P0.3
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    12

01A8 B127            716             ACALL   Wait_short
                     717             
                     718     ;3.1.2. Настраиваем регистр S0_TXBUF_SIZE.
01AA C283            719             CLR             P0.3
01AC B127            720             ACALL   Wait_short
                     721             
01AE E4              722             CLR             A
01AF B141            723             ACALL   SPI0_W
                     724     
01B1 741F            725             MOV             A,              #S1_TXBUF_SIZE
01B3 B141            726             ACALL   SPI0_W
                     727     
01B5 740C            728             MOV             A,              #00001100b
01B7 B141            729             ACALL   SPI0_W
                     730     
01B9 7400            731             MOV             A,              #0x00
01BB B141            732             ACALL   SPI0_W
                     733                     
01BD D283            734             SETB    P0.3
01BF B127            735             ACALL   Wait_short
                     736     
                     737     ;3.2.1. Настраиваем регистр S2_RXBUF_SIZE.
01C1 C283            738             CLR             P0.3
01C3 B127            739             ACALL   Wait_short
                     740             
01C5 E4              741             CLR             A
01C6 B141            742             ACALL   SPI0_W
                     743     
01C8 741E            744             MOV             A,              #S1_RXBUF_SIZE
01CA B141            745             ACALL   SPI0_W
                     746     
01CC 7454            747             MOV             A,              #01010100b
01CE B141            748             ACALL   SPI0_W
                     749     
01D0 7400            750             MOV             A,              #0x00
01D2 B141            751             ACALL   SPI0_W
                     752             
01D4 D283            753             SETB    P0.3
01D6 B127            754             ACALL   Wait_short
                     755             
                     756     ;3.2.2. Настраиваем регистр S2_TXBUF_SIZE.
01D8 C283            757             CLR             P0.3
01DA B127            758             ACALL   Wait_short
                     759             
01DC E4              760             CLR             A
01DD B141            761             ACALL   SPI0_W
                     762     
01DF 741F            763             MOV             A,              #S1_TXBUF_SIZE
01E1 B141            764             ACALL   SPI0_W
                     765     
01E3 7454            766             MOV             A,              #01010100b
01E5 B141            767             ACALL   SPI0_W
                     768     
01E7 7400            769             MOV             A,              #0x00
01E9 B141            770             ACALL   SPI0_W
                     771                     
01EB D283            772             SETB    P0.3
01ED B127            773             ACALL   Wait_short
                     774             
                     775     ;3.3.1. Настраиваем регистр S3_RXBUF_SIZE.
01EF C283            776             CLR             P0.3
01F1 B127            777             ACALL   Wait_short
                     778             
01F3 E4              779             CLR             A
01F4 B141            780             ACALL   SPI0_W
                     781     
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    13

01F6 741E            782             MOV             A,              #S1_RXBUF_SIZE
01F8 B141            783             ACALL   SPI0_W
                     784     
01FA 746C            785             MOV             A,              #01101100b
01FC B141            786             ACALL   SPI0_W
                     787     
01FE 7404            788             MOV             A,              #0x04
0200 B141            789             ACALL   SPI0_W
                     790             
0202 D283            791             SETB    P0.3
0204 B127            792             ACALL   Wait_short
                     793             
                     794     ;3.3.2. Настраиваем регистр S3_TXBUF_SIZE.
0206 C283            795             CLR             P0.3
0208 B127            796             ACALL   Wait_short
                     797             
020A E4              798             CLR             A
020B B141            799             ACALL   SPI0_W
                     800     
020D 741F            801             MOV             A,              #S1_TXBUF_SIZE
020F B141            802             ACALL   SPI0_W
                     803     
0211 746C            804             MOV             A,              #01101100b
0213 B141            805             ACALL   SPI0_W
                     806     
0215 7408            807             MOV             A,              #0x08
0217 B141            808             ACALL   SPI0_W
                     809                     
0219 D283            810             SETB    P0.3
021B B127            811             ACALL   Wait_short
                     812             
                     813     ;3.4.1. Настраиваем регистр S4_RXBUF_SIZE.
021D C283            814             CLR             P0.3
021F B127            815             ACALL   Wait_short
                     816             
0221 E4              817             CLR             A
0222 B141            818             ACALL   SPI0_W
                     819     
0224 741E            820             MOV             A,              #S1_RXBUF_SIZE
0226 B141            821             ACALL   SPI0_W
                     822     
0228 748C            823             MOV             A,              #10001100b
022A B141            824             ACALL   SPI0_W
                     825     
022C 7402            826             MOV             A,              #0x02
022E B141            827             ACALL   SPI0_W
                     828             
0230 D283            829             SETB    P0.3
0232 B127            830             ACALL   Wait_short
                     831             
                     832     ;3.4.2. Настраиваем регистр S4_TXBUF_SIZE.
0234 C283            833             CLR             P0.3
0236 B127            834             ACALL   Wait_short
                     835             
0238 E4              836             CLR             A
0239 B141            837             ACALL   SPI0_W
                     838     
023B 741F            839             MOV             A,              #S1_TXBUF_SIZE
023D B141            840             ACALL   SPI0_W
                     841     
023F 748C            842             MOV             A,              #10001100b
0241 B141            843             ACALL   SPI0_W
                     844     
0243 7402            845             MOV             A,              #0x02
0245 B141            846             ACALL   SPI0_W
                     847                     
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    14

0247 D283            848             SETB    P0.3
0249 B127            849             ACALL   Wait_short
                     850             
                     851     ;3.5.1. Настраиваем регистр S5_RXBUF_SIZE.
024B C283            852             CLR             P0.3
024D B127            853             ACALL   Wait_short
                     854             
024F E4              855             CLR             A
0250 B141            856             ACALL   SPI0_W
                     857     
0252 741E            858             MOV             A,              #S1_RXBUF_SIZE
0254 B141            859             ACALL   SPI0_W
                     860     
0256 74AC            861             MOV             A,              #10101100b
0258 B141            862             ACALL   SPI0_W
                     863     
025A 7400            864             MOV             A,              #0x00
025C B141            865             ACALL   SPI0_W
                     866             
025E D283            867             SETB    P0.3
0260 B127            868             ACALL   Wait_short
                     869             
                     870     ;3.5.2. Настраиваем регистр S5_TXBUF_SIZE.
0262 C283            871             CLR             P0.3
0264 B127            872             ACALL   Wait_short
                     873             
0266 E4              874             CLR             A
0267 B141            875             ACALL   SPI0_W
                     876     
0269 741F            877             MOV             A,              #S1_TXBUF_SIZE
026B B141            878             ACALL   SPI0_W
                     879     
026D 74AC            880             MOV             A,              #10101100b
026F B141            881             ACALL   SPI0_W
                     882     
0271 7400            883             MOV             A,              #0x00
0273 B141            884             ACALL   SPI0_W
                     885                     
0275 D283            886             SETB    P0.3
0277 B127            887             ACALL   Wait_short
                     888     
                     889     ;3.6.1. Настраиваем регистр S6_RXBUF_SIZE.
0279 C283            890             CLR             P0.3
027B B127            891             ACALL   Wait_short
                     892             
027D E4              893             CLR             A
027E B141            894             ACALL   SPI0_W
                     895     
0280 741E            896             MOV             A,              #S1_RXBUF_SIZE
0282 B141            897             ACALL   SPI0_W
                     898     
0284 74CC            899             MOV             A,              #11001100b
0286 B141            900             ACALL   SPI0_W
                     901     
0288 7400            902             MOV             A,              #0x00
028A B141            903             ACALL   SPI0_W
                     904             
028C D283            905             SETB    P0.3
028E B127            906             ACALL   Wait_short
                     907             
                     908     ;3.6.2. Настраиваем регистр S6_TXBUF_SIZE.
0290 C283            909             CLR             P0.3
0292 B127            910             ACALL   Wait_short
                     911             
0294 E4              912             CLR             A
0295 B141            913             ACALL   SPI0_W
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    15

                     914     
0297 741F            915             MOV             A,              #S1_TXBUF_SIZE
0299 B141            916             ACALL   SPI0_W
                     917     
029B 74CC            918             MOV             A,              #11001100b
029D B141            919             ACALL   SPI0_W
                     920     
029F 7400            921             MOV             A,              #0x00
02A1 B141            922             ACALL   SPI0_W
                     923                     
02A3 D283            924             SETB    P0.3
02A5 B127            925             ACALL   Wait_short
                     926             
                     927     ;3.7.1. Настраиваем регистр S7_RXBUF_SIZE.
02A7 C283            928             CLR             P0.3
02A9 B127            929             ACALL   Wait_short
                     930             
02AB E4              931             CLR             A
02AC B141            932             ACALL   SPI0_W
                     933     
02AE 741E            934             MOV             A,              #S1_RXBUF_SIZE
02B0 B141            935             ACALL   SPI0_W
                     936     
02B2 74EC            937             MOV             A,              #11101100b
02B4 B141            938             ACALL   SPI0_W
                     939     
02B6 7402            940             MOV             A,              #0x02
02B8 B141            941             ACALL   SPI0_W
                     942             
02BA D283            943             SETB    P0.3
02BC B127            944             ACALL   Wait_short
                     945             
                     946     ;3.7.2. Настраиваем регистр S7_TXBUF_SIZE.
02BE C283            947             CLR             P0.3
02C0 B127            948             ACALL   Wait_short
                     949             
02C2 E4              950             CLR             A
02C3 B141            951             ACALL   SPI0_W
                     952     
02C5 741F            953             MOV             A,              #S1_TXBUF_SIZE
02C7 B141            954             ACALL   SPI0_W
                     955     
02C9 74EC            956             MOV             A,              #11101100b
02CB B141            957             ACALL   SPI0_W
                     958     
02CD 7404            959             MOV             A,              #0x04
02CF B141            960             ACALL   SPI0_W
                     961                     
02D1 D283            962             SETB    P0.3
02D3 B127            963             ACALL   Wait_short
                     964     ;-----------------------------------------      
                     965                     
                     966     ;Сделаем первую небольшую проверку.
02D5 C283            967             CLR             P0.3
02D7 B127            968             ACALL   Wait_short
                     969             
02D9 E4              970             CLR             A
02DA B141            971             ACALL   SPI0_W
                     972     
02DC 7403            973             MOV             A,              #S1_SR
02DE B141            974             ACALL   SPI0_W
                     975     
02E0 7428            976             MOV             A,              #00101000b
02E2 B141            977             ACALL   SPI0_W
                     978             
02E4 E4              979             CLR             A
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    16

02E5 B135            980             ACALL   SPI0_R
                     981             
02E7 D283            982             SETB    P0.3
02E9 B127            983             ACALL   Wait_short
                     984     ;Как видим, сокет пока закрыт.
                     985     
                     986     ;Откроем сокет 1.
02EB C283            987             CLR             P0.3
02ED B127            988             ACALL   Wait_short
                     989             
02EF E4              990             CLR             A
02F0 B141            991             ACALL   SPI0_W
                     992     
02F2 7401            993             MOV             A,              #S1_CR
02F4 B141            994             ACALL   SPI0_W
                     995     
02F6 742C            996             MOV             A,              #00101100b
02F8 B141            997             ACALL   SPI0_W
                     998             
02FA 7401            999             MOV             A,              #0x01
02FC B141           1000             ACALL   SPI0_W
                    1001             
02FE D283           1002             SETB    P0.3
0300 B127           1003             ACALL   Wait_short
                    1004             
                    1005             
                    1006     
0302                1007     Poll_Open:
                    1008     ;Теперь в статусе мы дожны увидеть 0x22.
0302 C283           1009             CLR             P0.3
0304 B127           1010             ACALL   Wait_short
                    1011             
0306 E4             1012             CLR             A
0307 B141           1013             ACALL   SPI0_W
                    1014     
0309 7403           1015             MOV             A,              #S1_SR
030B B141           1016             ACALL   SPI0_W
                    1017     
030D 7428           1018             MOV             A,              #00101000b
030F B141           1019             ACALL   SPI0_W
                    1020             
0311 E4             1021             CLR             A
0312 B135           1022             ACALL   SPI0_R
                    1023             
0314 D283           1024             SETB    P0.3
0316 B127           1025             ACALL   Wait_short      
                    1026             
0318 B422E7         1027             CJNE    A,              #0x22,          Poll_Open
                    1028             
                    1029     
                    1030     ;Дождемся, пока на сокете 1 произойдет прерывание.
031B                1031     Wait_for_an_interrupt:
031B C283           1032             CLR             P0.3
031D B127           1033             ACALL   Wait_short
                    1034             
031F E4             1035             CLR             A
0320 B141           1036             ACALL   SPI0_W
                    1037     
0322 7402           1038             MOV             A,              #S1_IR
0324 B141           1039             ACALL   SPI0_W
                    1040     
0326 7428           1041             MOV             A,              #00101000b
0328 B141           1042             ACALL   SPI0_W
                    1043     
032A E4             1044             CLR             A
032B B135           1045             ACALL   SPI0_R
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    17

                    1046                     
032D D283           1047             SETB    P0.3
032F B127           1048             ACALL   Wait_short
                    1049             
0331 30E2E7         1050             JNB     ACC.2,  Wait_for_an_interrupt   ;       Переход, если бит равен нулю.
                    1051     
                    1052     ;Обнуляем флажок.
0334 C283           1053             CLR             P0.3
0336 B127           1054             ACALL   Wait_short
                    1055             
0338 E4             1056             CLR             A
0339 B141           1057             ACALL   SPI0_W
                    1058     
033B 7402           1059             MOV             A,              #S1_IR
033D B141           1060             ACALL   SPI0_W
                    1061     
033F 742C           1062             MOV             A,              #00101100b
0341 B141           1063             ACALL   SPI0_W
                    1064     
0343 7404           1065             MOV             A,              #00000100b
0345 B141           1066             ACALL   SPI0_W
                    1067                     
0347 D283           1068             SETB    P0.3
0349 B127           1069             ACALL   Wait_short
                    1070     
                    1071     ;Проверяем, что флажок обнулился.
034B                1072     Flag_clearance_check:
034B C283           1073             CLR             P0.3
034D B127           1074             ACALL   Wait_short
                    1075             
034F E4             1076             CLR             A
0350 B141           1077             ACALL   SPI0_W
                    1078     
0352 7402           1079             MOV             A,              #S1_IR
0354 B141           1080             ACALL   SPI0_W
                    1081     
0356 7428           1082             MOV             A,              #00101000b
0358 B141           1083             ACALL   SPI0_W
                    1084     
035A E4             1085             CLR             A
035B B135           1086             ACALL   SPI0_R
                    1087                     
035D D283           1088             SETB    P0.3
035F B127           1089             ACALL   Wait_short
                    1090             
0361 20E2E7         1091             JB              ACC.2,  Flag_clearance_check            ;       Переход, если бит р
                             авен единице.
                    1092     
                    1093     
                    1094     ;Сейчас мне хочется понять, что будет в регистре S1_RX_RD. В общем, счиатем его. Т.е. извле
                             каем положение уяказателя чтения.
0364 C283           1095             CLR             P0.3
0366 B127           1096             ACALL   Wait_short
                    1097             
0368 E4             1098             CLR             A
0369 B141           1099             ACALL   SPI0_W
                    1100     
036B 7428           1101             MOV             A,              #S1_RX_RD
036D B141           1102             ACALL   SPI0_W
                    1103     
036F 7428           1104             MOV             A,              #00101000b              ;Внимание, мы считываем рег
                             истры!
0371 B141           1105             ACALL   SPI0_W
                    1106     
0373 E4             1107             CLR             A
0374 B135           1108             ACALL   SPI0_R
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    18

0376 F583           1109             MOV             DPH,    A
                    1110     
0378 E4             1111             CLR             A
0379 B135           1112             ACALL   SPI0_R
037B F582           1113             MOV             DPL,    A
                    1114     
037D D283           1115             SETB    P0.3
037F B127           1116             ACALL   Wait_short
                    1117     
                    1118     ;Понимам, с какого адреса стоит начинать считывать длинну данных.
                    1119     ;Надо как-то корректно прибавить 6.
0381 E582           1120             MOV     A,              DPL
0383 C3             1121             CLR     C
0384 3406           1122             ADDC    A,              #6
0386 F582           1123             MOV     DPL,     A
                    1124     
0388 E583           1125             MOV     A,              DPH
038A 9400           1126             SUBB    A,              #0
038C F583           1127             MOV     DPH,     A
                    1128     
                    1129             
                    1130     ;Считываем длинну данных.
038E C283           1131             CLR             P0.3
0390 B127           1132             ACALL   Wait_short
                    1133             
0392 E583           1134             MOV     A,              DPH
0394 B141           1135             ACALL   SPI0_W
                    1136     
0396 E582           1137             MOV     A,              DPL
0398 B141           1138             ACALL   SPI0_W
                    1139     
039A 7438           1140             MOV             A,              #00111000b              
039C B141           1141             ACALL   SPI0_W
                    1142     
039E E4             1143             CLR             A
039F B135           1144             ACALL   SPI0_R
03A1 FA             1145             MOV             R2,             A
                    1146             
03A2 E4             1147             CLR             A
03A3 B135           1148             ACALL   SPI0_R
03A5 FB             1149             MOV             R3,             A
                    1150                     
03A6 D283           1151             SETB    P0.3
03A8 B127           1152             ACALL   Wait_short
                    1153             
                    1154     ;Теперь начинаем считывать данные и отслеживать, сколько их считалось.
03AA E582           1155             MOV     A,              DPL
03AC C3             1156             CLR     C
03AD 3402           1157             ADDC    A,              #2
03AF F582           1158             MOV     DPL,     A
                    1159     
03B1 E583           1160             MOV     A,              DPH
03B3 3400           1161             ADDC    A,              #0
03B5 F583           1162             MOV     DPH,     A
                    1163             
                    1164     ;Непосредственно считываем байты данных.
03B7                1165     Read_1_byte:
03B7 C283           1166             CLR             P0.3
03B9 B127           1167             ACALL   Wait_short
                    1168             
03BB E583           1169             MOV             A,              DPH
03BD B141           1170             ACALL   SPI0_W
                    1171     
03BF E582           1172             MOV             A,              DPL
03C1 B141           1173             ACALL   SPI0_W
                    1174     
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    19

03C3 7438           1175             MOV             A,              #00111000b
03C5 B141           1176             ACALL   SPI0_W
                    1177     
03C7 E4             1178             CLR             A
03C8 B135           1179             ACALL   SPI0_R
                    1180                     
03CA D283           1181             SETB    P0.3
03CC B127           1182             ACALL   Wait_short
                    1183             
                    1184     ;Декремент длинны.
03CE EB             1185             MOV     A,              R3
03CF C3             1186             CLR     C
03D0 9401           1187             SUBB    A,              #1
03D2 FB             1188             MOV     R3,      A
                    1189     
03D3 EA             1190             MOV     A,              R2
03D4 9400           1191             SUBB    A,              #0
03D6 FA             1192             MOV     R2,             A
                    1193     
                    1194     ;Проверяем, закончились ли данные? Сделаем логическое "ИЛИ" аккумулятора и регистра.
03D7 E582           1195             MOV     A,              DPL
03D9 C3             1196             CLR     C
03DA 3401           1197             ADDC    A,              #1
03DC F582           1198             MOV     DPL,     A
                    1199     
03DE E583           1200             MOV     A,              DPH
03E0 3400           1201             ADDC    A,              #0
03E2 F583           1202             MOV     DPH,     A
                    1203             
03E4 EA             1204             MOV             A,              R2
03E5 4B             1205             ORL             A,              R3
                    1206             
03E6 6003           1207             JZ              Data_has_run_out                ;Переход, если аккумулятор равен 0.
                    1208             
03E8 0203B7         1209             LJMP    Read_1_byte
                    1210     
03EB                1211     Data_has_run_out:
                    1212     ;Обновляем регистр S1_RX_RD.
03EB C283           1213             CLR             P0.3
03ED B127           1214             ACALL   Wait_short
                    1215             
03EF E4             1216             CLR             A
03F0 B141           1217             ACALL   SPI0_W
                    1218     
03F2 7428           1219             MOV             A,              #S1_RX_RD
03F4 B141           1220             ACALL   SPI0_W
                    1221     
03F6 742C           1222             MOV             A,              #00101100b              
03F8 B141           1223             ACALL   SPI0_W
                    1224     
03FA E583           1225             MOV     A,              DPH
03FC B141           1226             ACALL   SPI0_W
                    1227     
03FE E582           1228             MOV     A,              DPL
0400 B141           1229             ACALL   SPI0_W
                    1230     
0402 D283           1231             SETB    P0.3
0404 B127           1232             ACALL   Wait_short
                    1233     
                    1234     ;Теперь даем команду, что прием обслужен.
0406 C283           1235             CLR             P0.3
0408 B127           1236             ACALL   Wait_short
                    1237             
040A E4             1238             CLR             A
040B B141           1239             ACALL   SPI0_W
                    1240     
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    20

040D 7401           1241             MOV             A,              #S1_CR
040F B141           1242             ACALL   SPI0_W
                    1243     
0411 742C           1244             MOV             A,              #00101100b              
0413 B141           1245             ACALL   SPI0_W
                    1246     
0415 7440           1247             MOV     A,              #0x40 
0417 B141           1248             ACALL   SPI0_W
                    1249     
0419 D283           1250             SETB    P0.3
041B B127           1251             ACALL   Wait_short
                    1252     
                    1253     ;LJMP   Wait_for_an_interrupt
                    1254     
041D AC83           1255             MOV             R4,             DPH
041F AD82           1256             MOV             R5,             DPL
                    1257     
                    1258     
                    1259     
                    1260     
                    1261     
                    1262     
                    1263     ;------------------------------------------------------------------------------------------
                             ---------------------------------------
                    1264     ;------------------------------------------------------------------------------------------
                             ---------------------------------------
                    1265     ;Запишем несколько регистров.
                    1266     ;1.1.
0421 C283           1267             CLR             P0.3
0423 B127           1268             ACALL   Wait_short
                    1269             
0425 E4             1270             CLR             A
0426 B141           1271             ACALL   SPI0_W
                    1272     
0428 740C           1273             MOV             A,              #S1_DIPR
042A B141           1274             ACALL   SPI0_W
                    1275     
042C 742C           1276             MOV             A,              #00101100b
042E B141           1277             ACALL   SPI0_W
                    1278     
0430 74C0           1279             MOV             A,              #0xC0
0432 B141           1280             ACALL   SPI0_W
                    1281             
0434 74A8           1282             MOV             A,              #0xA8
0436 B141           1283             ACALL   SPI0_W
                    1284             
0438 7414           1285             MOV             A,              #0x14
043A B141           1286             ACALL   SPI0_W
                    1287             
043C 7402           1288             MOV             A,              #0x02
043E B141           1289             ACALL   SPI0_W
                    1290             
0440 D283           1291             SETB    P0.3
0442 B127           1292             ACALL   Wait_short
                    1293     
                    1294     ;1.2.
0444 C283           1295             CLR             P0.3
0446 B127           1296             ACALL   Wait_short
                    1297             
0448 E4             1298             CLR             A
0449 B141           1299             ACALL   SPI0_W
                    1300     
044B 7410           1301             MOV             A,              #S1_DPORT
044D B141           1302             ACALL   SPI0_W
                    1303     
044F 742C           1304             MOV             A,              #00101100b
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    21

0451 B141           1305             ACALL   SPI0_W
                    1306     
0453 740F           1307             MOV             A,              #0x0F
0455 B141           1308             ACALL   SPI0_W
                    1309             
0457 74B7           1310             MOV             A,              #0xB7
0459 B141           1311             ACALL   SPI0_W
                    1312             
045B D283           1313             SETB    P0.3
045D B127           1314             ACALL   Wait_short
                    1315     
                    1316     
                    1317     ;Считываем из регистра S1_Tx_WR адрес, куда записывать данные.
045F C283           1318             CLR             P0.3
0461 B127           1319             ACALL   Wait_short
                    1320             
0463 E4             1321             CLR             A
0464 B141           1322             ACALL   SPI0_W
                    1323     
0466 7424           1324             MOV             A,              #S1_TX_WR
0468 B141           1325             ACALL   SPI0_W
                    1326     
046A 7428           1327             MOV             A,              #00101000b              ;Внимание, мы считываем рег
                             истры!
046C B141           1328             ACALL   SPI0_W
                    1329     
046E E4             1330             CLR             A
046F B135           1331             ACALL   SPI0_R
0471 F583           1332             MOV             DPH,    A
                    1333     
0473 E4             1334             CLR             A
0474 B135           1335             ACALL   SPI0_R
0476 F582           1336             MOV             DPL,    A
                    1337     
0478 D283           1338             SETB    P0.3
047A B127           1339             ACALL   Wait_short
                    1340     
                    1341     ;Определяемся для себя сколько байт данных мы собираемся передавать.
047C 7E02           1342             MOV             R6,             #2                      ;Т.е. мы будем передавать 2
                              байта данных.
047E 7FA7           1343             MOV             R7,             #0xA7           ;А именно число A7.
                    1344             
                    1345     ;Записываем в буфер ти несчастные данные по полученному адресу.
0480                1346     Write_1_byte:
0480 C283           1347             CLR             P0.3
0482 B127           1348             ACALL   Wait_short
                    1349             
0484 E583           1350             MOV             A,              DPH
0486 B141           1351             ACALL   SPI0_W
                    1352     
0488 E582           1353             MOV             A,              DPL
048A B141           1354             ACALL   SPI0_W
                    1355     
048C 7434           1356             MOV             A,              #00110100b
048E B141           1357             ACALL   SPI0_W
                    1358     
0490 EF             1359             MOV             A,              R7
0491 B141           1360             ACALL   SPI0_W
                    1361                     
0493 D283           1362             SETB    P0.3
0495 B127           1363             ACALL   Wait_short
                    1364     
                    1365     ;Декремент длинны. 
0497 EE             1366             MOV     A,              R6
0498 C3             1367             CLR     C
0499 9401           1368             SUBB    A,              #1
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    22

049B FE             1369             MOV     R6,             A                       ;Его явно стоит доработать, если в 
                             том будет необходимость.
                    1370             ;MOV    A,              R2
                    1371             ;SUBB   A,              #0
                    1372             ;MOV    R2,             A
                    1373             
                    1374     ;Перемещаем указатель записи.
049C E582           1375             MOV     A,              DPL
049E C3             1376             CLR     C
049F 3401           1377             ADDC    A,              #1
04A1 F582           1378             MOV     DPL,     A
                    1379     
04A3 E583           1380             MOV     A,              DPH
04A5 3400           1381             ADDC    A,              #0
04A7 F583           1382             MOV     DPH,     A
                    1383     
                    1384     ;Проверяем, все ли данные мы передали, которые хотели передать?
04A9 EE             1385             MOV     A,              R6
04AA 70D4           1386             JNZ     Write_1_byte                    ;Переход, если аккумулятор не равен 0.
                    1387     
                    1388     ;Перезаписываем регистр S1_TX_WR.
04AC C283           1389             CLR             P0.3
04AE B127           1390             ACALL   Wait_short
                    1391             
04B0 E4             1392             CLR             A
04B1 B141           1393             ACALL   SPI0_W
                    1394     
04B3 7424           1395             MOV             A,              #S1_TX_WR
04B5 B141           1396             ACALL   SPI0_W
                    1397     
04B7 742C           1398             MOV             A,              #00101100b              
04B9 B141           1399             ACALL   SPI0_W
                    1400     
04BB E583           1401             MOV     A,              DPH
04BD B141           1402             ACALL   SPI0_W
                    1403     
04BF E582           1404             MOV     A,              DPL
04C1 B141           1405             ACALL   SPI0_W
                    1406     
04C3 D283           1407             SETB    P0.3
04C5 B127           1408             ACALL   Wait_short
                    1409             
                    1410     ;Теперь надо как-то то закончить какой-то командой.
04C7 C283           1411             CLR             P0.3
04C9 B127           1412             ACALL   Wait_short
                    1413             
04CB E4             1414             CLR             A
04CC B141           1415             ACALL   SPI0_W
                    1416     
04CE 7401           1417             MOV             A,              #S1_CR
04D0 B141           1418             ACALL   SPI0_W
                    1419     
04D2 742C           1420             MOV             A,              #00101100b              
04D4 B141           1421             ACALL   SPI0_W
                    1422     
04D6 7420           1423             MOV     A,              #0x20 
04D8 B141           1424             ACALL   SPI0_W
                    1425     
04DA D283           1426             SETB    P0.3
04DC B127           1427             ACALL   Wait_short
                    1428     
                    1429     ;Проверяем, что отправка завершена.
04DE                1430     Wait_for_an_interrupt_t:
04DE C283           1431             CLR             P0.3
04E0 B127           1432             ACALL   Wait_short
                    1433             
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    23

04E2 E4             1434             CLR             A
04E3 B141           1435             ACALL   SPI0_W
                    1436     
04E5 7402           1437             MOV             A,              #S1_IR
04E7 B141           1438             ACALL   SPI0_W
                    1439     
04E9 7428           1440             MOV             A,              #00101000b
04EB B141           1441             ACALL   SPI0_W
                    1442     
04ED E4             1443             CLR             A
04EE B135           1444             ACALL   SPI0_R
                    1445                     
04F0 D283           1446             SETB    P0.3
04F2 B127           1447             ACALL   Wait_short
                    1448             
04F4 30E4E7         1449             JNB     ACC.4,  Wait_for_an_interrupt_t ;       Переход, если бит равен нулю.
                    1450     
                    1451     ;Обнуляем флажок.
04F7 C283           1452             CLR             P0.3
04F9 B127           1453             ACALL   Wait_short
                    1454             
04FB E4             1455             CLR             A
04FC B141           1456             ACALL   SPI0_W
                    1457     
04FE 7402           1458             MOV             A,              #S1_IR
0500 B141           1459             ACALL   SPI0_W
                    1460     
0502 742C           1461             MOV             A,              #00101100b
0504 B141           1462             ACALL   SPI0_W
                    1463     
0506 7410           1464             MOV             A,              #00010000b
0508 B141           1465             ACALL   SPI0_W
                    1466                     
050A D283           1467             SETB    P0.3
050C B127           1468             ACALL   Wait_short
                    1469     
                    1470     ;Проверяем, что флажок обнулился.
050E                1471     Flag_clearance_check_t:
050E C283           1472             CLR             P0.3
0510 B127           1473             ACALL   Wait_short
                    1474             
0512 E4             1475             CLR             A
0513 B141           1476             ACALL   SPI0_W
                    1477     
0515 7402           1478             MOV             A,              #S1_IR
0517 B141           1479             ACALL   SPI0_W
                    1480     
0519 7428           1481             MOV             A,              #00101000b
051B B141           1482             ACALL   SPI0_W
                    1483     
051D E4             1484             CLR             A
051E B135           1485             ACALL   SPI0_R
                    1486                     
0520 D283           1487             SETB    P0.3
0522 B127           1488             ACALL   Wait_short
                    1489             
0524 20E4E7         1490             JB              ACC.4,  Flag_clearance_check_t          ;       Переход, если бит р
                             авен единице.
                    1491     
                    1492     
                    1493             
                    1494     ;$include (My_library_for_W5500.inc)
                +1  1495     
  00A0          +1  1496     PIN_RSTN        EQU             P2.0
  0000          +1  1497     MR                      EQU             0x00
  0001          +1  1498     GAR1            EQU             0x01
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    24

  0005          +1  1499     SUBR1           EQU             0x05
  0009          +1  1500     SHAR1           EQU             0x09
  000F          +1  1501     SIPR1           EQU             0x0F
  0019          +1  1502     RTR1            EQU             0x19
  001B          +1  1503     RCR1            EQU             0x1B
                +1  1504     
  0000          +1  1505     S1_MR           EQU             0x00
  0004          +1  1506     S1_PORT         EQU             0x04
  0016          +1  1507     S1_TTL          EQU             0x16
  001E          +1  1508     S1_RXBUF_SIZE   EQU             0x1E
  001F          +1  1509     S1_TXBUF_SIZE   EQU             0x1F
  0003          +1  1510     S1_SR           EQU             0x03
  0001          +1  1511     S1_CR           EQU             0x01
  002A          +1  1512     S1_RX_WR        EQU             0x2A
  0028          +1  1513     S1_RX_RD        EQU             0x28
  0002          +1  1514     S1_IR           EQU             0x02
                +1  1515     
  0018          +1  1516     MSIR            EQU             0x18
  0017          +1  1517     SIR                     EQU             0x17
                +1  1518     
  0024          +1  1519     S1_TX_WR        EQU             0x24
                +1  1520             
  000C          +1  1521     S1_DIPR         EQU             0x0C
  0010          +1  1522     S1_DPORT        EQU             0x10
  0006          +1  1523     S1_DHAR         EQU             0x06    
                +1  1524             
                +1  1525             
                +1  1526             
                +1  1527     
0527            +1  1528     Wait_short:
0527 7864       +1  1529             MOV             R0,                     #100
0529            +1  1530             Wait_sh:
0529 D8FE       +1  1531                     DJNZ    R0,                     Wait_sh
052B 22         +1  1532     RET
                +1  1533     
052C            +1  1534     Wait_long:
052C 7800       +1  1535             MOV             R0,             #0
052E 7900       +1  1536             MOV             R1,             #0
                +1  1537             
0530            +1  1538             Wait_ln:
0530 D8FE       +1  1539                     DJNZ    R0,             Wait_ln
0532 D9FC       +1  1540                     DJNZ    R1,             Wait_ln
0534 22         +1  1541     RET
                +1  1542     
                +1  1543     
0535            +1  1544     SPI0_R:
0535 F59B       +1  1545             MOV             SPI0DAT,        A
                +1  1546     
                +1  1547     ;poll_SPIF_r:
0537 30FFFD     +1  1548             JNB             SPIF,           $ ;poll_SPIF_r          
053A C2FF       +1  1549             CLR             SPIF
                +1  1550     
053C E59B       +1  1551             MOV             A,                      SPI0DAT
053E B127       +1  1552             ACALL   Wait_short
0540 22         +1  1553     RET
                +1  1554     
0541            +1  1555     SPI0_W:
0541 F59B       +1  1556             MOV             SPI0DAT,        A
                +1  1557     
                +1  1558     ;poll_SPIF_w:
0543 30FFFD     +1  1559             JNB             SPIF,           $ ; poll_SPIF_w 
0546 C2FF       +1  1560             CLR             SPIF
0548 22         +1  1561     RET
                +1  1562     
                +1  1563     
                +1  1564     
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    25

                +1  1565     
                    1566     
                    1567     
                    1568     END
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    26

SYMBOL TABLE LISTING
------ ----- -------


N A M E                  T Y P E  V A L U E   ATTRIBUTES

AA. . . . . . . . . . .  B ADDR   00C0H.2 A   
AC. . . . . . . . . . .  B ADDR   00D0H.6 A   
ACC . . . . . . . . . .  D ADDR   00E0H   A   
AD0BUSY . . . . . . . .  B ADDR   00E8H.4 A   
AD0CM0. . . . . . . . .  B ADDR   00E8H.2 A   
AD0CM1. . . . . . . . .  B ADDR   00E8H.3 A   
AD0EN . . . . . . . . .  B ADDR   00E8H.7 A   
AD0INT. . . . . . . . .  B ADDR   00E8H.5 A   
AD0LJST . . . . . . . .  B ADDR   00E8H.0 A   
AD0TM . . . . . . . . .  B ADDR   00E8H.6 A   
AD0WINT . . . . . . . .  B ADDR   00E8H.1 A   
AD2BUSY . . . . . . . .  B ADDR   00E8H.4 A   
AD2CM0. . . . . . . . .  B ADDR   00E8H.1 A   
AD2CM1. . . . . . . . .  B ADDR   00E8H.2 A   
AD2CM2. . . . . . . . .  B ADDR   00E8H.3 A   
AD2EN . . . . . . . . .  B ADDR   00E8H.7 A   
AD2INT. . . . . . . . .  B ADDR   00E8H.5 A   
AD2TM . . . . . . . . .  B ADDR   00E8H.6 A   
AD2WINT . . . . . . . .  B ADDR   00E8H.0 A   
ADC0CF. . . . . . . . .  D ADDR   00BCH   A   
ADC0CN. . . . . . . . .  D ADDR   00E8H   A   
ADC0GTH . . . . . . . .  D ADDR   00C5H   A   
ADC0GTL . . . . . . . .  D ADDR   00C4H   A   
ADC0H . . . . . . . . .  D ADDR   00BFH   A   
ADC0L . . . . . . . . .  D ADDR   00BEH   A   
ADC0LTH . . . . . . . .  D ADDR   00C7H   A   
ADC0LTL . . . . . . . .  D ADDR   00C6H   A   
ADC0_PAGE . . . . . . .  N NUMB   0000H   A   
ADC2. . . . . . . . . .  D ADDR   00BEH   A   
ADC2CF. . . . . . . . .  D ADDR   00BCH   A   
ADC2CN. . . . . . . . .  D ADDR   00E8H   A   
ADC2GT. . . . . . . . .  D ADDR   00C4H   A   
ADC2LT. . . . . . . . .  D ADDR   00C6H   A   
ADC2_PAGE . . . . . . .  N NUMB   0002H   A   
AMX0CF. . . . . . . . .  D ADDR   00BAH   A   
AMX0SL. . . . . . . . .  D ADDR   00BBH   A   
AMX2CF. . . . . . . . .  D ADDR   00BAH   A   
AMX2SL. . . . . . . . .  D ADDR   00BBH   A   
B . . . . . . . . . . .  D ADDR   00F0H   A   
BUSY. . . . . . . . . .  B ADDR   00C0H.7 A   
CCF0. . . . . . . . . .  B ADDR   00D8H.0 A   
CCF1. . . . . . . . . .  B ADDR   00D8H.1 A   
CCF2. . . . . . . . . .  B ADDR   00D8H.2 A   
CCF3. . . . . . . . . .  B ADDR   00D8H.3 A   
CCF4. . . . . . . . . .  B ADDR   00D8H.4 A   
CCF5. . . . . . . . . .  B ADDR   00D8H.5 A   
CCH0CN. . . . . . . . .  D ADDR   00A1H   A   
CCH0LC. . . . . . . . .  D ADDR   00A3H   A   
CCH0MA. . . . . . . . .  D ADDR   009AH   A   
CCH0TN. . . . . . . . .  D ADDR   00A2H   A   
CF. . . . . . . . . . .  B ADDR   00D8H.7 A   
CKCON . . . . . . . . .  D ADDR   008EH   A   
CLKSEL. . . . . . . . .  D ADDR   0097H   A   
CONFIG_PAGE . . . . . .  N NUMB   000FH   A   
CP0EN . . . . . . . . .  B ADDR   0088H.7 A   
CP0FIF. . . . . . . . .  B ADDR   0088H.4 A   
CP0HYN0 . . . . . . . .  B ADDR   0088H.0 A   
CP0HYN1 . . . . . . . .  B ADDR   0088H.1 A   
CP0HYP0 . . . . . . . .  B ADDR   0088H.2 A   
CP0HYP1 . . . . . . . .  B ADDR   0088H.3 A   
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    27

CP0OUT. . . . . . . . .  B ADDR   0088H.6 A   
CP0RIF. . . . . . . . .  B ADDR   0088H.5 A   
CP1EN . . . . . . . . .  B ADDR   0088H.7 A   
CP1FIF. . . . . . . . .  B ADDR   0088H.4 A   
CP1HYN0 . . . . . . . .  B ADDR   0088H.0 A   
CP1HYN1 . . . . . . . .  B ADDR   0088H.1 A   
CP1HYP0 . . . . . . . .  B ADDR   0088H.2 A   
CP1HYP1 . . . . . . . .  B ADDR   0088H.3 A   
CP1OUT. . . . . . . . .  B ADDR   0088H.6 A   
CP1RIF. . . . . . . . .  B ADDR   0088H.5 A   
CPRL2 . . . . . . . . .  B ADDR   00C8H.0 A   
CPRL3 . . . . . . . . .  B ADDR   00C8H.0 A   
CPRL4 . . . . . . . . .  B ADDR   00C8H.0 A   
CPT0CN. . . . . . . . .  D ADDR   0088H   A   
CPT0MD. . . . . . . . .  D ADDR   0089H   A   
CPT0_PAGE . . . . . . .  N NUMB   0001H   A   
CPT1CN. . . . . . . . .  D ADDR   0088H   A   
CPT1MD. . . . . . . . .  D ADDR   0089H   A   
CPT1_PAGE . . . . . . .  N NUMB   0002H   A   
CR. . . . . . . . . . .  B ADDR   00D8H.6 A   
CT2 . . . . . . . . . .  B ADDR   00C8H.1 A   
CT3 . . . . . . . . . .  B ADDR   00C8H.1 A   
CT4 . . . . . . . . . .  B ADDR   00C8H.1 A   
CY. . . . . . . . . . .  B ADDR   00D0H.7 A   
DAC0CN. . . . . . . . .  D ADDR   00D4H   A   
DAC0H . . . . . . . . .  D ADDR   00D3H   A   
DAC0L . . . . . . . . .  D ADDR   00D2H   A   
DAC0_PAGE . . . . . . .  N NUMB   0000H   A   
DAC1CN. . . . . . . . .  D ADDR   00D4H   A   
DAC1H . . . . . . . . .  D ADDR   00D3H   A   
DAC1L . . . . . . . . .  D ADDR   00D2H   A   
DAC1_PAGE . . . . . . .  N NUMB   0001H   A   
DATA_HAS_RUN_OUT. . . .  C ADDR   03EBH   A   
DPH . . . . . . . . . .  D ADDR   0083H   A   
DPL . . . . . . . . . .  D ADDR   0082H   A   
EA. . . . . . . . . . .  B ADDR   00A8H.7 A   
EIE1. . . . . . . . . .  D ADDR   00E6H   A   
EIE2. . . . . . . . . .  D ADDR   00E7H   A   
EIP1. . . . . . . . . .  D ADDR   00F6H   A   
EIP2. . . . . . . . . .  D ADDR   00F7H   A   
EMI0CF. . . . . . . . .  D ADDR   00A3H   A   
EMI0CN. . . . . . . . .  D ADDR   00A2H   A   
EMI0TC. . . . . . . . .  D ADDR   00A1H   A   
EMI0_PAGE . . . . . . .  N NUMB   0000H   A   
ENSMB . . . . . . . . .  B ADDR   00C0H.6 A   
ES0 . . . . . . . . . .  B ADDR   00A8H.4 A   
ET0 . . . . . . . . . .  B ADDR   00A8H.1 A   
ET1 . . . . . . . . . .  B ADDR   00A8H.3 A   
ET2 . . . . . . . . . .  B ADDR   00A8H.5 A   
EX0 . . . . . . . . . .  B ADDR   00A8H.0 A   
EX1 . . . . . . . . . .  B ADDR   00A8H.2 A   
EXEN2 . . . . . . . . .  B ADDR   00C8H.3 A   
EXEN3 . . . . . . . . .  B ADDR   00C8H.3 A   
EXEN4 . . . . . . . . .  B ADDR   00C8H.3 A   
EXF2. . . . . . . . . .  B ADDR   00C8H.6 A   
EXF3. . . . . . . . . .  B ADDR   00C8H.6 A   
EXF4. . . . . . . . . .  B ADDR   00C8H.6 A   
F0. . . . . . . . . . .  B ADDR   00D0H.5 A   
F1. . . . . . . . . . .  B ADDR   00D0H.1 A   
FLACL . . . . . . . . .  D ADDR   00B7H   A   
FLAG_CLEARANCE_CHECK. .  C ADDR   034BH   A   
FLAG_CLEARANCE_CHECK_T.  C ADDR   050EH   A   
FLHBUSY . . . . . . . .  B ADDR   0088H.0 A   
FLSCL . . . . . . . . .  D ADDR   00B7H   A   
FLSTAT. . . . . . . . .  D ADDR   0088H   A   
GAR1. . . . . . . . . .  N NUMB   0001H   A   
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    28

IE. . . . . . . . . . .  D ADDR   00A8H   A   
IE0 . . . . . . . . . .  B ADDR   0088H.1 A   
IE1 . . . . . . . . . .  B ADDR   0088H.3 A   
IP. . . . . . . . . . .  D ADDR   00B8H   A   
IT0 . . . . . . . . . .  B ADDR   0088H.0 A   
IT1 . . . . . . . . . .  B ADDR   0088H.2 A   
LEGACY_PAGE . . . . . .  N NUMB   0000H   A   
MAC0ACC0. . . . . . . .  D ADDR   0093H   A   
MAC0ACC1. . . . . . . .  D ADDR   0094H   A   
MAC0ACC2. . . . . . . .  D ADDR   0095H   A   
MAC0ACC3. . . . . . . .  D ADDR   0096H   A   
MAC0AH. . . . . . . . .  D ADDR   00C2H   A   
MAC0AL. . . . . . . . .  D ADDR   00C1H   A   
MAC0BH. . . . . . . . .  D ADDR   0092H   A   
MAC0BL. . . . . . . . .  D ADDR   0091H   A   
MAC0CF. . . . . . . . .  D ADDR   00C3H   A   
MAC0HO. . . . . . . . .  B ADDR   00C0H.3 A   
MAC0N . . . . . . . . .  B ADDR   00C0H.0 A   
MAC0OVR . . . . . . . .  D ADDR   0097H   A   
MAC0RNDH. . . . . . . .  D ADDR   00CFH   A   
MAC0RNDL. . . . . . . .  D ADDR   00CEH   A   
MAC0SO. . . . . . . . .  B ADDR   00C0H.1 A   
MAC0STA . . . . . . . .  D ADDR   00C0H   A   
MAC0Z . . . . . . . . .  B ADDR   00C0H.2 A   
MAC0_PAGE . . . . . . .  N NUMB   0003H   A   
MCE1. . . . . . . . . .  B ADDR   0098H.5 A   
MODF. . . . . . . . . .  B ADDR   00F8H.5 A   
MR. . . . . . . . . . .  N NUMB   0000H   A   
MSIR. . . . . . . . . .  N NUMB   0018H   A   
NSSMD0. . . . . . . . .  B ADDR   00F8H.2 A   
NSSMD1. . . . . . . . .  B ADDR   00F8H.3 A   
OSCICL. . . . . . . . .  D ADDR   008BH   A   
OSCICN. . . . . . . . .  D ADDR   008AH   A   
OSCXCN. . . . . . . . .  D ADDR   008CH   A   
OV. . . . . . . . . . .  B ADDR   00D0H.2 A   
P . . . . . . . . . . .  B ADDR   00D0H.0 A   
P0. . . . . . . . . . .  D ADDR   0080H   A   
P0MDOUT . . . . . . . .  D ADDR   00A4H   A   
P1. . . . . . . . . . .  D ADDR   0090H   A   
P1MDIN. . . . . . . . .  D ADDR   00ADH   A   
P1MDOUT . . . . . . . .  D ADDR   00A5H   A   
P2. . . . . . . . . . .  D ADDR   00A0H   A   
P2MDOUT . . . . . . . .  D ADDR   00A6H   A   
P3. . . . . . . . . . .  D ADDR   00B0H   A   
P3MDOUT . . . . . . . .  D ADDR   00A7H   A   
P4. . . . . . . . . . .  D ADDR   00C8H   A   
P4MDOUT . . . . . . . .  D ADDR   009CH   A   
P5. . . . . . . . . . .  D ADDR   00D8H   A   
P5MDOUT . . . . . . . .  D ADDR   009DH   A   
P6. . . . . . . . . . .  D ADDR   00E8H   A   
P6MDOUT . . . . . . . .  D ADDR   009EH   A   
P7. . . . . . . . . . .  D ADDR   00F8H   A   
P7MDOUT . . . . . . . .  D ADDR   009FH   A   
PCA0CN. . . . . . . . .  D ADDR   00D8H   A   
PCA0CPH0. . . . . . . .  D ADDR   00FCH   A   
PCA0CPH1. . . . . . . .  D ADDR   00FEH   A   
PCA0CPH2. . . . . . . .  D ADDR   00EAH   A   
PCA0CPH3. . . . . . . .  D ADDR   00ECH   A   
PCA0CPH4. . . . . . . .  D ADDR   00EEH   A   
PCA0CPH5. . . . . . . .  D ADDR   00E2H   A   
PCA0CPL0. . . . . . . .  D ADDR   00FBH   A   
PCA0CPL1. . . . . . . .  D ADDR   00FDH   A   
PCA0CPL2. . . . . . . .  D ADDR   00E9H   A   
PCA0CPL3. . . . . . . .  D ADDR   00EBH   A   
PCA0CPL4. . . . . . . .  D ADDR   00EDH   A   
PCA0CPL5. . . . . . . .  D ADDR   00E1H   A   
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    29

PCA0CPM0. . . . . . . .  D ADDR   00DAH   A   
PCA0CPM1. . . . . . . .  D ADDR   00DBH   A   
PCA0CPM2. . . . . . . .  D ADDR   00DCH   A   
PCA0CPM3. . . . . . . .  D ADDR   00DDH   A   
PCA0CPM4. . . . . . . .  D ADDR   00DEH   A   
PCA0CPM5. . . . . . . .  D ADDR   00DFH   A   
PCA0H . . . . . . . . .  D ADDR   00FAH   A   
PCA0L . . . . . . . . .  D ADDR   00F9H   A   
PCA0MD. . . . . . . . .  D ADDR   00D9H   A   
PCA0_PAGE . . . . . . .  N NUMB   0000H   A   
PCON. . . . . . . . . .  D ADDR   0087H   A   
PIN_RSTN. . . . . . . .  B ADDR   00A0H.0 A   
PLL0CN. . . . . . . . .  D ADDR   0089H   A   
PLL0DIV . . . . . . . .  D ADDR   008DH   A   
PLL0FLT . . . . . . . .  D ADDR   008FH   A   
PLL0MUL . . . . . . . .  D ADDR   008EH   A   
PLL0_PAGE . . . . . . .  N NUMB   000FH   A   
POLL_OPEN . . . . . . .  C ADDR   0302H   A   
PS. . . . . . . . . . .  B ADDR   00B8H.4 A   
PSBANK. . . . . . . . .  D ADDR   00B1H   A   
PSCTL . . . . . . . . .  D ADDR   008FH   A   
PSW . . . . . . . . . .  D ADDR   00D0H   A   
PT0 . . . . . . . . . .  B ADDR   00B8H.1 A   
PT1 . . . . . . . . . .  B ADDR   00B8H.3 A   
PT2 . . . . . . . . . .  B ADDR   00B8H.5 A   
PX0 . . . . . . . . . .  B ADDR   00B8H.0 A   
PX1 . . . . . . . . . .  B ADDR   00B8H.2 A   
RB80. . . . . . . . . .  B ADDR   0098H.2 A   
RB81. . . . . . . . . .  B ADDR   0098H.2 A   
RCAP2H. . . . . . . . .  D ADDR   00CBH   A   
RCAP2L. . . . . . . . .  D ADDR   00CAH   A   
RCAP3H. . . . . . . . .  D ADDR   00CBH   A   
RCAP3L. . . . . . . . .  D ADDR   00CAH   A   
RCAP4H. . . . . . . . .  D ADDR   00CBH   A   
RCAP4L. . . . . . . . .  D ADDR   00CAH   A   
RCR1. . . . . . . . . .  N NUMB   001BH   A   
READ_1_BYTE . . . . . .  C ADDR   03B7H   A   
REF0CN. . . . . . . . .  D ADDR   00D1H   A   
REN0. . . . . . . . . .  B ADDR   0098H.4 A   
REN1. . . . . . . . . .  B ADDR   0098H.4 A   
RI0 . . . . . . . . . .  B ADDR   0098H.0 A   
RI1 . . . . . . . . . .  B ADDR   0098H.0 A   
RS0 . . . . . . . . . .  B ADDR   00D0H.3 A   
RS1 . . . . . . . . . .  B ADDR   00D0H.4 A   
RSTSRC. . . . . . . . .  D ADDR   00EFH   A   
RTR1. . . . . . . . . .  N NUMB   0019H   A   
RXOVRN. . . . . . . . .  B ADDR   00F8H.4 A   
S1MODE. . . . . . . . .  B ADDR   0098H.7 A   
S1_CR . . . . . . . . .  N NUMB   0001H   A   
S1_DHAR . . . . . . . .  N NUMB   0006H   A   
S1_DIPR . . . . . . . .  N NUMB   000CH   A   
S1_DPORT. . . . . . . .  N NUMB   0010H   A   
S1_IR . . . . . . . . .  N NUMB   0002H   A   
S1_MR . . . . . . . . .  N NUMB   0000H   A   
S1_PORT . . . . . . . .  N NUMB   0004H   A   
S1_RXBUF_SIZE . . . . .  N NUMB   001EH   A   
S1_RX_RD. . . . . . . .  N NUMB   0028H   A   
S1_RX_WR. . . . . . . .  N NUMB   002AH   A   
S1_SR . . . . . . . . .  N NUMB   0003H   A   
S1_TTL. . . . . . . . .  N NUMB   0016H   A   
S1_TXBUF_SIZE . . . . .  N NUMB   001FH   A   
S1_TX_WR. . . . . . . .  N NUMB   0024H   A   
SADDR0. . . . . . . . .  D ADDR   00A9H   A   
SADEN0. . . . . . . . .  D ADDR   00B9H   A   
SBUF0 . . . . . . . . .  D ADDR   0099H   A   
SBUF1 . . . . . . . . .  D ADDR   0099H   A   
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    30

SCON0 . . . . . . . . .  D ADDR   0098H   A   
SCON1 . . . . . . . . .  D ADDR   0098H   A   
SFRLAST . . . . . . . .  D ADDR   0086H   A   
SFRNEXT . . . . . . . .  D ADDR   0085H   A   
SFRPAGE . . . . . . . .  D ADDR   0084H   A   
SFRPGCN . . . . . . . .  D ADDR   0096H   A   
SHAR1 . . . . . . . . .  N NUMB   0009H   A   
SI. . . . . . . . . . .  B ADDR   00C0H.3 A   
SIPR1 . . . . . . . . .  N NUMB   000FH   A   
SIR . . . . . . . . . .  N NUMB   0017H   A   
SM00. . . . . . . . . .  B ADDR   0098H.7 A   
SM10. . . . . . . . . .  B ADDR   0098H.6 A   
SM20. . . . . . . . . .  B ADDR   0098H.5 A   
SMB0ADR . . . . . . . .  D ADDR   00C3H   A   
SMB0CN. . . . . . . . .  D ADDR   00C0H   A   
SMB0CR. . . . . . . . .  D ADDR   00CFH   A   
SMB0DAT . . . . . . . .  D ADDR   00C2H   A   
SMB0STA . . . . . . . .  D ADDR   00C1H   A   
SMB0_PAGE . . . . . . .  N NUMB   0000H   A   
SMBFTE. . . . . . . . .  B ADDR   00C0H.1 A   
SMBTOE. . . . . . . . .  B ADDR   00C0H.0 A   
SP. . . . . . . . . . .  D ADDR   0081H   A   
SPI0CFG . . . . . . . .  D ADDR   009AH   A   
SPI0CKR . . . . . . . .  D ADDR   009DH   A   
SPI0CN. . . . . . . . .  D ADDR   00F8H   A   
SPI0DAT . . . . . . . .  D ADDR   009BH   A   
SPI0_PAGE . . . . . . .  N NUMB   0000H   A   
SPI0_R. . . . . . . . .  C ADDR   0535H   A   
SPI0_W. . . . . . . . .  C ADDR   0541H   A   
SPIEN . . . . . . . . .  B ADDR   00F8H.0 A   
SPIF. . . . . . . . . .  B ADDR   00F8H.7 A   
SSTA0 . . . . . . . . .  D ADDR   0091H   A   
STA . . . . . . . . . .  B ADDR   00C0H.5 A   
STO . . . . . . . . . .  B ADDR   00C0H.4 A   
SUBR1 . . . . . . . . .  N NUMB   0005H   A   
TB80. . . . . . . . . .  B ADDR   0098H.3 A   
TB81. . . . . . . . . .  B ADDR   0098H.3 A   
TCON. . . . . . . . . .  D ADDR   0088H   A   
TF0 . . . . . . . . . .  B ADDR   0088H.5 A   
TF1 . . . . . . . . . .  B ADDR   0088H.7 A   
TF2 . . . . . . . . . .  B ADDR   00C8H.7 A   
TF3 . . . . . . . . . .  B ADDR   00C8H.7 A   
TF4 . . . . . . . . . .  B ADDR   00C8H.7 A   
TH0 . . . . . . . . . .  D ADDR   008CH   A   
TH1 . . . . . . . . . .  D ADDR   008DH   A   
TI0 . . . . . . . . . .  B ADDR   0098H.1 A   
TI1 . . . . . . . . . .  B ADDR   0098H.1 A   
TIMER01_PAGE. . . . . .  N NUMB   0000H   A   
TL0 . . . . . . . . . .  D ADDR   008AH   A   
TL1 . . . . . . . . . .  D ADDR   008BH   A   
TMOD. . . . . . . . . .  D ADDR   0089H   A   
TMR2CF. . . . . . . . .  D ADDR   00C9H   A   
TMR2CN. . . . . . . . .  D ADDR   00C8H   A   
TMR2H . . . . . . . . .  D ADDR   00CDH   A   
TMR2L . . . . . . . . .  D ADDR   00CCH   A   
TMR2_PAGE . . . . . . .  N NUMB   0000H   A   
TMR3CF. . . . . . . . .  D ADDR   00C9H   A   
TMR3CN. . . . . . . . .  D ADDR   00C8H   A   
TMR3H . . . . . . . . .  D ADDR   00CDH   A   
TMR3L . . . . . . . . .  D ADDR   00CCH   A   
TMR3_PAGE . . . . . . .  N NUMB   0001H   A   
TMR4CF. . . . . . . . .  D ADDR   00C9H   A   
TMR4CN. . . . . . . . .  D ADDR   00C8H   A   
TMR4H . . . . . . . . .  D ADDR   00CDH   A   
TMR4L . . . . . . . . .  D ADDR   00CCH   A   
TMR4_PAGE . . . . . . .  N NUMB   0002H   A   
A51 MACRO ASSEMBLER  MAIN                                                                 09/12/2023 01:02:30 PAGE    31

TR0 . . . . . . . . . .  B ADDR   0088H.4 A   
TR1 . . . . . . . . . .  B ADDR   0088H.6 A   
TR2 . . . . . . . . . .  B ADDR   00C8H.2 A   
TR3 . . . . . . . . . .  B ADDR   00C8H.2 A   
TR4 . . . . . . . . . .  B ADDR   00C8H.2 A   
TXBMT . . . . . . . . .  B ADDR   00F8H.1 A   
UART0_PAGE. . . . . . .  N NUMB   0000H   A   
UART1_PAGE. . . . . . .  N NUMB   0001H   A   
WAIT_FOR_AN_INTERRUPT .  C ADDR   031BH   A   
WAIT_FOR_AN_INTERRUPT_T  C ADDR   04DEH   A   
WAIT_LN . . . . . . . .  C ADDR   0530H   A   
WAIT_LONG . . . . . . .  C ADDR   052CH   A   
WAIT_SH . . . . . . . .  C ADDR   0529H   A   
WAIT_SHORT. . . . . . .  C ADDR   0527H   A   
WCOL. . . . . . . . . .  B ADDR   00F8H.6 A   
WDTCN . . . . . . . . .  D ADDR   00FFH   A   
WRITE_1_BYTE. . . . . .  C ADDR   0480H   A   
XBR0. . . . . . . . . .  D ADDR   00E1H   A   
XBR1. . . . . . . . . .  D ADDR   00E2H   A   
XBR2. . . . . . . . . .  D ADDR   00E3H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
